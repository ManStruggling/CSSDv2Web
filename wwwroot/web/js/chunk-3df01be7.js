(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3df01be7"],{"0078":function(t,a,e){},"06f1":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"basic_package_box",attrs:{id:"basic_count_number_package"},on:{click:function(a){return a.target!==a.currentTarget?null:t.cancelSend(a)}}},[e("div",{staticClass:"package_box"},[e("h3",[e("el-input",{attrs:{placeholder:"请输入拼音简码"},on:{input:t.packageSearch},model:{value:t.searchShortCode,callback:function(a){t.searchShortCode=a},expression:"searchShortCode"}})],1),e("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.packageList,"tooltip-effect":"dark","max-height":"280",width:"400","row-key":t.getRowKeys},on:{"selection-change":t.handleSelectionChange,"row-click":t.handleRowClick}},[e("el-table-column",{attrs:{type:"selection",width:"55","reserve-selection":!0}}),e("el-table-column",{attrs:{prop:"ProductName",label:"包名称",width:"201","show-overflow-tooltip":!0}}),e("el-table-column",{attrs:{prop:"ProvideSubClinicName",label:"回收科室",width:"120"}}),e("el-table-column",{attrs:{label:"数量","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input-number",{attrs:{controls:!1,min:1,max:a.row.MaximumQuantity},on:{change:function(e,i){t.handleNumberChange(e,i,a.$index)}},model:{value:a.row.ProductQuantity,callback:function(e){t.$set(a.row,"ProductQuantity",e)},expression:"props.row.ProductQuantity"}})]}}])})],1),e("h4",[e("el-button",{on:{click:t.cancelSend}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.sendToFather}},[t._v("确定")])],1)],1)])},n=[],r={data:function(){return{searchShortCode:"",packageList:[],multipleSelection:[]}},props:["getApi"],methods:{handleRowClick:function(t){this.$refs.multipleTable.toggleRowSelection(t)},handleNumberChange:function(t,a,e){var i=this;void 0==t&&setTimeout(function(){i.packageList[e].ProductQuantity=1},0)},cancelSend:function(){this.$emit("countNumber-to-father","")},sendToFather:function(){this.$emit("countNumber-to-father",this.multipleSelection)},packageSearch:function(){var t=this;axios({url:"".concat(this.$props.getApi,"?$filter=contains(ProductShortCode,").concat("'"+this.searchShortCode+"'",") or contains(ProductName,").concat("'"+this.searchShortCode+"'",")")}).then(function(a){t.packageList=a.data.value}).catch(function(t){})},handleSelectionChange:function(t){this.multipleSelection=t},getRowKeys:function(t){return t.Id}},created:function(){var t=this;axios({url:this.$props.getApi}).then(function(a){t.packageList=a.data.value}).catch(function(t){})}},o=r,s=(e("44c4"),e("2877")),c=Object(s["a"])(o,i,n,!1,null,null,null);a["a"]=c.exports},"44c4":function(t,a,e){"use strict";var i=e("5396"),n=e.n(i);n.a},5396:function(t,a,e){},9460:function(t,a,e){},9599:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"cssd_box",attrs:{id:"sterilizeReady"}},[e("div",{staticClass:"cssd_title"},[e("ul",{staticClass:"cssd_menu"},[e("li",{on:{click:t.sterilizeReadyGoBack}},[e("p",[t._v("返回")])]),e("li",{on:{click:t.handleShowManualEnter}},[e("p",[t._v("手工录入")])]),e("li",{on:{click:t.handleShowCountPackages}},[e("p",[t._v("计数包登记")])]),t.sterilizeReadyChangeMode?t._e():e("router-link",{attrs:{to:"/sterilize/readyRecord",tag:"li"}},[e("p",[t._v("灭菌准备记录")])])],1),e("div",{staticClass:"cssd_title_right"},[e("p",[e("span",{directives:[{name:"show",rawName:"v-show",value:0===t.submitData.CarrierId,expression:"submitData.CarrierId===0"}]},[t._v("暂无网篮")]),e("span",{directives:[{name:"show",rawName:"v-show",value:0!=t.submitData.CarrierId,expression:"submitData.CarrierId!=0"}],staticClass:"hasCarrierData"},[t._v(t._s(t.submitData.CarrierName))])])])]),e("div",{staticClass:"cssd_table_center cssd_totalBar"},[e("div",{staticClass:"table_box table_unExpand"},[e("el-table",{attrs:{data:t.submitData.PackageBarCodes}},[e("el-table-column",{attrs:{label:"包名称",prop:"ProductName",width:"240"}}),e("el-table-column",{attrs:{label:"包条码",prop:"BarCode",width:"210"}}),e("el-table-column",{attrs:{label:"科室",prop:"ProvideSubClinicName",width:"210"}}),e("el-table-column",{attrs:{label:"包数量",width:"210"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.IsNotPrintBarCode?e("el-input-number",{attrs:{min:1,max:a.row.MaximumQuantity,size:"mini",controls:!1},on:{change:function(e,i){t.handleNumberChange(e,i,a.$index)}},model:{value:a.row.ProductQuantity,callback:function(e){t.$set(a.row,"ProductQuantity",e)},expression:"props.row.ProductQuantity"}}):t._e(),a.row.IsNotPrintBarCode?t._e():e("div",[t._v(t._s(a.row.ProductQuantity))])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"210"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.deletePackage(a.$index,a.row)}}},[t._v("删除")])]}}])}),e("el-table-column")],1)],1),e("div",{staticClass:"cssd_table_bottom"},[e("p",[e("s",[t._v("共计")]),e("b",[t._v(t._s(t.countPackageNumber(t.submitData.PackageBarCodes)))]),e("span",[t._v("包")])]),e("p",[t.sterilizeReadyChangeMode?e("el-button",{on:{click:t.cancelChange}},[t._v("取消修改")]):t._e(),e("el-button",{attrs:{type:"primary"},on:{click:t.sterilizeReadyComplete}},[t._v(t._s(t.sterilizeReadyChangeMode?"修改完成":"摆放完成"))])],1)])]),e("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[t.isShowCountNumberPackageList?e("CountNumberPackageList",{attrs:{getApi:"/odata/CanBeSterilizedNotBarCodeProduct"},on:{"countNumber-to-father":t.countNumberToFather}}):t._e()],1),e("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[t.isShowManualEnter?e("ManualEnter",{attrs:{ApiUrl:"/api/Scanner/SterilizeReady",BarCodeList:t.submitData.PackageBarCodes},on:{"to-father":t.packageData2father}}):t._e()],1)],1)},n=[],r=(e("ac6a"),e("d040")),o=e("06f1"),s={data:function(){return{sterilizeReadyChangeMode:!1,isShowManualEnter:!1,isShowCountNumberPackageList:!1,submitData:{CarrierId:0,CarrierName:"",PackageBarCodes:[]}}},components:{ManualEnter:r["a"],CountNumberPackageList:o["a"]},created:function(){var t=this;CSManager.handleDataThis=this,this.$route.query.recordId&&(this.sterilizeReadyChangeMode=!0,axios({url:"/api/Sterilize/PendingUpdateSterilizeReadyRecord/".concat(this.$route.query.recordId)}).then(function(a){200==a.data.Code?t.submitData=a.data.Data:t.showInformation({classify:"message",msg:a.data.Msg})}).catch(function(t){}))},beforeDestroy:function(){CSManager.handleDataThis=null},methods:{handleNumberChange:function(t,a,e){var i=this;void 0==t&&setTimeout(function(){i.submitData.PackageBarCodes[e].ProductQuantity=1},0)},sterilizeReadyGoBack:function(){this.sterilizeReadyChangeMode?this.$router.push("/sterilize/readyRecord"):this.$router.push("/sterilize/select")},handleShowCountPackages:function(){this.isShowCountNumberPackageList=!0},countNumberToFather:function(t){if(this.isShowCountNumberPackageList=!1,t)for(var a=!0,e=0;e<t.length;e++){for(var i=0;i<this.submitData.PackageBarCodes.length;i++)t[e].ProductId==this.submitData.PackageBarCodes[i].ProductId&&0==this.submitData.PackageBarCodes[i].PackageBarCodeId&&(a=!1,this.submitData.PackageBarCodes[i].ProductQuantity+=t[e].ProductQuantity);a&&this.submitData.PackageBarCodes.push(t[e])}},cancelChange:function(){this.$router.push({path:"/sterilize/readyRecord"})},deletePackage:function(t,a){var e=this;this.$confirm("您确定要删除该包吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.submitData.PackageBarCodes.splice(t,1)}).catch(function(){})},sterilizeReadyComplete:function(){var t=this,a="/api/Sterilize/SterilizeReadyComplete",e="POST";this.sterilizeReadyChangeMode&&(a="/api/Sterilize/SterilizeReadyRecordModify",e="PUT"),this.GLOBAL.VerificationHandle([{val:this.submitData.CarrierId,type:"NumberNotZero",msg:"您还没有关联网篮，请关联网篮！"},{val:this.submitData.PackageBarCodes,type:"ArrayNotEmpty",msg:"网篮至少关联一个包！"}])&&axios({url:a,method:e,data:this.submitData}).then(function(a){var e;200==a.data.Code?(e="success",t.sterilizeReadyChangeMode?t.$router.push({path:"/sterilize/readyRecord"}):t.$router.go(0)):e="error",t.showInformation({classify:"message",msg:a.data.Msg,type:e})}).catch(function(t){})},handleShowManualEnter:function(){this.isShowManualEnter=!0},packageData2father:function(t){var a=this;if(this.isShowManualEnter=!1,t){if(t.PackageBarCodeScannerVm)return void this.submitData.PackageBarCodes.push(t.PackageBarCodeScannerVm);if(t.CarrierBarCodeScannerVm)return void(0==this.submitData.CarrierId?(this.submitData.CarrierId=t.CarrierBarCodeScannerVm.Id,this.submitData.CarrierName=t.CarrierBarCodeScannerVm.Name,console.log("run")):this.$confirm("您已录入网篮,是否需要替换该网篮?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.submitData.CarrierId=t.CarrierBarCodeScannerVm.Id,a.submitData.CarrierName=t.CarrierBarCodeScannerVm.Name}).catch(function(){}))}},handleBarCode:function(t){var a=this,e=!0;this.submitData.PackageBarCodes.forEach(function(i){if(i.BarCode==t.toUpperCase())return a.showInformation({classify:"message",msg:"该条码已录入！",type:"warning"}),void(e=!1)}),e&&axios({url:"/api/Scanner/SterilizeReady/".concat(t)}).then(function(t){200==t.data.Code?a.packageData2father(t.data.Data):a.showInformation({classify:"message",msg:t.data.Msg})}).catch(function(t){})}},computed:{countPackageNumber:function(){return function(t){var a=0;return t.forEach(function(t){a+=t.ProductQuantity}),a}}}},c=s,u=(e("a6ba"),e("2877")),l=Object(u["a"])(c,i,n,!1,null,null,null);a["default"]=l.exports},a6ba:function(t,a,e){"use strict";var i=e("0078"),n=e.n(i);n.a},ac6a:function(t,a,e){for(var i=e("cadf"),n=e("0d58"),r=e("2aba"),o=e("7726"),s=e("32e9"),c=e("84f2"),u=e("2b4c"),l=u("iterator"),d=u("toStringTag"),h=c.Array,m={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=n(m),f=0;f<p.length;f++){var g,C=p[f],b=m[C],y=o[C],v=y&&y.prototype;if(v&&(v[l]||s(v,l,h),v[d]||s(v,d,C),c[C]=h,b))for(g in i)v[g]||r(v,g,i[g],!0)}},d040:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"manual_enter"}},[e("dl",[e("dt",[e("el-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{placeholder:"请扫描或手动录入条码"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.SaveOption(a)}},model:{value:t.input_str,callback:function(a){t.input_str="string"===typeof a?a.trim():a},expression:"input_str"}})],1),e("dd",[e("el-button",{on:{click:t.cancelOption}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.SaveOption}},[t._v("确定")])],1)])])},n=[],r=(e("ac6a"),{props:["BarCodeList","ApiUrl","task_index","firstRequest"],data:function(){return{input_str:""}},created:function(){},mounted:function(){},methods:{cancelOption:function(){this.$emit("to-father","")},SaveOption:function(){var t=this;this.GLOBAL.VerificationHandle([{val:this.input_str,type:"StringNotEmpty",msg:"扫描条码不能为空！"}])&&(this.$props.firstRequest?axios("".concat(this.$props.ApiUrl,"/").concat(this.input_str)).then(function(a){if(200==a.data.Code)if(t.$props.task_index>=0)t.$emit("to-father",{data:a.data.Data,index:t.$props.task_index});else{if(a.data.Data.PackageBarCodeScannerVm)for(var e=0;e<t.$props.BarCodeList.length;e++)if(t.$props.BarCodeList[e].BarCode==a.data.Data.PackageBarCodeScannerVm.BarCode)return t.showInformation({classify:"message",msg:"该条码已录入！",type:"warning"}),void(t.input_str="");t.$emit("to-father",a.data.Data,t.input_str)}else 300==a.data.Code?(t.input_str="",t.showInformation({classify:"message",msg:a.data.Msg,type:"warning"})):(t.input_str="",t.showInformation({classify:"message",msg:a.data.Msg,type:"error"}))}).catch(function(t){}):(this.$props.BarCodeList.forEach(function(a){if(a.BarCode==t.input_str.toUpperCase())return t.showInformation({classify:"message",msg:"该条码已录入！",type:"warning"}),void(t.input_str="")}),axios("".concat(this.$props.ApiUrl,"/").concat(this.input_str)).then(function(a){200==a.data.Code?t.$props.task_index>=0?t.$emit("to-father",{data:a.data.Data,index:t.$props.task_index}):t.$emit("to-father",a.data.Data,t.input_str):300==a.data.Code?(t.input_str="",t.showInformation({classify:"message",msg:a.data.Msg,type:"warning"})):(t.input_str="",t.showInformation({classify:"message",msg:a.data.Msg,type:"error"}))}).catch(function(t){})))}}}),o=r,s=(e("dda8"),e("2877")),c=Object(s["a"])(o,i,n,!1,null,null,null);a["a"]=c.exports},dda8:function(t,a,e){"use strict";var i=e("9460"),n=e.n(i);n.a}}]);