(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aee1b646"],{"1a4b":function(a,e,t){"use strict";var n=t("24bb"),i=t.n(n);i.a},"24bb":function(a,e,t){},"329a":function(a,e,t){"use strict";var n=t("6883"),i=t.n(n);i.a},"34f4":function(a,e,t){"use strict";t.r(e);var n=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"cleanReview"},[t("transition",{attrs:{name:"fade","enter-active-class":"animated  faster fadeInRight","leave-active-class":"animated  faster fadeOutLeft"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:a.isShowCleanView,expression:"isShowCleanView"}],staticClass:"cssd_box",attrs:{id:"cleanCheck"}},[t("div",{staticClass:"cssd_title"},[t("ul",{staticClass:"cssd_menu"},[t("router-link",{attrs:{to:"/package/taskList",tag:"li"}},[t("p",[a._v("返回")])]),t("router-link",{attrs:{to:"/package/cleanCheckRecord",tag:"li"}},[t("p",[a._v("清洗审核记录")])])],1)]),t("div",{staticClass:"cssd_table_center cssd_table_subTabs review_check"},[t("div",{staticClass:"cssd_table_left"},[t("div",{staticClass:"cssd_talbe_left_menu"},[t("dl",{staticClass:"isActive"},[t("dt",{staticClass:"reviewStatus"},[t("span",[a._v("待审核")])]),t("dd",{staticClass:"reviewDd",staticStyle:{display:"block"}},[t("el-tabs",{attrs:{"tab-position":"left",activeName:"0"}},a._l(a.cleanTask.CleanPendingReviewTasks,function(e,n){return t("el-tab-pane",{key:n,attrs:{label:e.CleanBarCode,name:n+""}},[t("div",{staticClass:"tab_content"},[t("div",{staticClass:"checkStatusBox"},[t("p",[a._v("清洗审核结果")]),t("el-select",{staticClass:"green24x13",attrs:{filterable:"","allow-create":"","default-first-option":""},model:{value:e.CleanReviewResult,callback:function(t){a.$set(e,"CleanReviewResult",t)},expression:"item.CleanReviewResult"}},[t("el-option",{attrs:{label:"合格",value:2}}),t("el-option",{attrs:{label:"不合格",value:3}}),t("el-option",{attrs:{label:"部分合格",value:4}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:4==e.CleanReviewResult,expression:"item.CleanReviewResult==4?true:false"}],staticClass:"unqualifiedCarrier"},[t("p",[a._v("不合格包")]),t("span",[a._v(a._s(a.countFailedPackageNumber(n)))]),t("b",{on:{click:function(e){return a.handleFailedPackages(n)}}},[a._v("编辑")])])],1),t("ul",{staticClass:"clear_float"},[t("li",[t("p",[a._v("清洗开始时间")]),t("span",[a._v(a._s(e.CleanStartTime))])]),t("li",[t("p",[a._v("清洗结束时间")]),t("span",[a._v(a._s(e.CleanEndTime))])]),t("li",[t("p",[a._v("清洗人")]),t("span",[a._v(a._s(e.Cleaner))])])]),t("ul",{staticClass:"clear_float"},[t("li",[t("p",[a._v("清洗设备")]),t("span",[a._v(a._s(e.CleanDeviceModel))])]),t("li",[t("p",[a._v("清洗程序")]),t("span",[a._v(a._s(e.CleanDeviceModelProgram))])])]),t("ul",{staticClass:"clear_float"},[t("li",[t("p",[a._v("清洗当日锅次")]),t("span",[a._v(a._s(e.CleanTodayBatch))])]),t("li",[t("p",[a._v("清洗总锅次")]),t("span",[a._v(a._s(e.CleanTotalBatch))])])]),t("ul",{staticClass:"clear_float"},[t("li",[t("p",[a._v("质量卡记录")]),t("el-select",{staticClass:"green24x13",model:{value:e.CleaningQualityCard,callback:function(t){a.$set(e,"CleaningQualityCard",t)},expression:"item.CleaningQualityCard"}},[t("el-option",{attrs:{label:"未做",value:0}}),t("el-option",{attrs:{label:"通过",value:1}}),t("el-option",{attrs:{label:"不通过",value:2}})],1)],1),t("li",{staticClass:"myTextarea"},[t("p",[a._v("备注")]),t("el-input",{attrs:{type:"textarea",resize:"none",placeholder:"填写备注",maxlength:"20","show-word-limit":""},model:{value:e.Remark,callback:function(t){a.$set(e,"Remark",t)},expression:"item.Remark"}})],1)]),t("div",{staticClass:"tab_content_bottom"},[t("el-button",{staticClass:"btn150x40main",on:{click:function(e){return a.submitCheckResult(n)}}},[a._v("审核完成")])],1)])])}),1)],1)]),t("dl",[t("dt",{staticClass:"reviewStatus"},[t("span",[a._v("清洗中")])]),t("dd",{staticClass:"reviewDd"},[t("el-tabs",{attrs:{"tab-position":"left",activeName:"0"}},a._l(a.cleanTask.CleanCleaningTasks,function(e,n){return t("el-tab-pane",{key:n,attrs:{label:e.CleanBarCode,name:n+""}},[t("div",{staticClass:"tab_content"},[t("div",{staticClass:"timerBox"},[t("p",[a._v(a._s(a.timeFormatDuring(e.RemainingTime)))]),t("span",{on:{click:function(e){return a.resetDeviceTime(n)}}})]),t("ul",{staticClass:"clear_float"},[t("li",[t("p",[a._v("清洗开始时间")]),t("span",[a._v(a._s(e.CleanStartTime))])]),t("li",[t("p",[a._v("清洗人")]),t("span",[a._v(a._s(e.Cleaner))])])]),t("ul",{staticClass:"clear_float"},[t("li",[t("p",[a._v("清洗设备")]),t("span",[a._v(a._s(e.CleanDeviceModel))])]),t("li",[t("p",[a._v("清洗程序")]),t("span",[a._v(a._s(e.CleanDeviceModelProgram))])])]),t("ul",{staticClass:"clear_float"},[t("li",[t("p",[a._v("清洗当日锅次")]),t("span",[a._v(a._s(e.CleanTodayBatch))])]),t("li",[t("p",[a._v("清洗总锅次")]),t("span",[a._v(a._s(e.CleanTotalBatch))])])])])])}),1)],1)])])]),t("div",{staticClass:"cssd_table_right"})])])]),t("transition",{attrs:{name:"fade","enter-active-class":"animated  faster fadeInRight","leave-active-class":"animated  faster fadeOutLeft"}},[a.isShowCleanFailedPackages?t("CleanFailedPackages",{attrs:{failedCarriers:a.failedCarrier,taskId:a.taskId},on:{"cleanFailed-to-father":a.cleanFailedToFather}}):a._e()],1)],1)},i=[],s=(t("7514"),t("ac6a"),function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"cssd_totalBar tabs_totalBar",attrs:{id:"cleanFailedPackageList"}},[t("el-tabs",{attrs:{type:"border-card","tab-position":"left"}},a._l(a.carrierList,function(e,n){return t("el-tab-pane",{key:n,attrs:{name:n+""}},[t("div",{attrs:{slot:"label"},slot:"label"},[t("p",[a._v(a._s(e.BarCode))])]),t("div",{staticClass:"tab_content table_collapse table_unExpand"},[t("div",{staticClass:"content_title"},[t("p",[a._v("包名称")]),t("p",[a._v("包数量")]),t("p",[a._v("回收科室")]),t("p",[a._v("不合格包数量")])]),t("el-collapse",{attrs:{accordion:""}},a._l(e.Packages,function(e,i){return t("el-collapse-item",{key:i,class:e.IsOuterProduct?"collapseUnExpand":"",attrs:{name:i+""}},[t("div",{staticClass:"collapseTh",attrs:{slot:"title"},slot:"title"},[t("div",{staticClass:"collapseTd"},[t("p",[a._v(a._s(e.ProductName))])]),t("div",{staticClass:"collapseTd"},[t("p",[a._v("\n                  "+a._s(e.OriginalQuantity)+"\n                  "),0!=e.ExpeditedPackageQuantity?t("span",{staticClass:"expeditedTag"},[a._v("加急 : "+a._s(e.ExpeditedPackageQuantity))]):a._e()])]),t("div",{staticClass:"collapseTd"},[t("p",[a._v(a._s(e.SubClinicName))])]),t("div",{staticClass:"collapseTd"},[e.IsOuterProduct?t("el-input-number",{attrs:{controls:!1,min:0,max:e.OriginalQuantity},on:{change:function(t,n){a.handelNumberChange(t,n,e)}},model:{value:e.CanNotBePackagedCount,callback:function(t){a.$set(e,"CanNotBePackagedCount",t)},expression:"value.CanNotBePackagedCount"}}):a._e(),e.IsOuterProduct?a._e():t("p",[a._v(a._s(e.CanNotBePackagedCount))])],1)]),e.IsOuterProduct?a._e():t("el-table",{attrs:{data:e.Instruments}},[t("el-table-column",{attrs:{label:"器械名称",prop:"InstrumentName",width:"240"}}),t("el-table-column",{attrs:{label:"规格",prop:"Specification",width:"210"}}),t("el-table-column",{attrs:{label:"器械总数",width:"210"},scopedSlots:a._u([{key:"default",fn:function(t){return[a._v(a._s(t.row.InstrumentCount*e.OriginalQuantity))]}}],null,!0)}),t("el-table-column",{attrs:{label:"不合格器械总数",width:"210"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("span",{staticClass:"failedNumberSpan"},[a._v(a._s(e.row.FailedInstrumentCount))]),t("a",{on:{click:function(t){return a.editCleanQuality(n,i,e.$index)}}},[a._v("编辑")])]}}],null,!0)}),t("el-table-column")],1)],1)}),1)],1)])}),1),t("div",{staticClass:"cssd_table_bottom"},[t("p",[t("el-button",{on:{click:a.cancel}},[a._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:a.saveData}},[a._v("保存")])],1)]),t("transition",{attrs:{name:"fade","enter-active-class":"animated  faster fadeIn","leave-active-class":"animated  faster fadeOut"}},[a.isShowUnqualifiedInstruments?t("UnqualifiedInstruments",{attrs:{data:a.cleanQuality,carrierIndex:a.carrier_index,packageIndex:a.package_index,instrumentIndex:a.instrument_index,maxNum:a.max_num},on:{"UnqualifiedInstruments-to-father":a.UnqualifiedInstruments}}):a._e()],1)],1)}),l=[],r=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{attrs:{id:"unqualifiedInstrument"}},[t("div",{staticClass:"container"},[t("h5",{staticClass:"left"},[a._v("总数:"+a._s(a.cleanQuality.Surface+a.cleanQuality.Joint+a.cleanQuality.Tooth+a.cleanQuality.Ware))]),t("h6",{staticClass:"right"},[a._v("总数:"+a._s(a.cleanQuality.Stains+a.cleanQuality.BloodStain+a.cleanQuality.RustStain))]),t("el-table",{attrs:{data:[{}],border:!1,"max-height":"162"}},[t("el-table-column",{attrs:{prop:""}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"mainTitle"},[a._v("\n            器械及器皿\n          ")])]),t("el-table-column",{attrs:{prop:"",label:"表面",width:"100"}},[t("el-input-number",{attrs:{min:0,max:999,controls:!1},on:{change:function(e,t){a.handleNumberChange(e,t,"Surface")}},model:{value:a.cleanQuality.Surface,callback:function(e){a.$set(a.cleanQuality,"Surface",e)},expression:"cleanQuality.Surface"}})],1),t("el-table-column",{attrs:{prop:"",label:"关节",width:"100"}},[t("el-input-number",{attrs:{min:0,max:999,controls:!1},on:{change:function(e,t){a.handleNumberChange(e,t,"Joint")}},model:{value:a.cleanQuality.Joint,callback:function(e){a.$set(a.cleanQuality,"Joint",e)},expression:"cleanQuality.Joint"}})],1),t("el-table-column",{attrs:{prop:"",label:"齿牙",width:"100"}},[t("el-input-number",{attrs:{min:0,max:999,controls:!1},on:{change:function(e,t){a.handleNumberChange(e,t,"Tooth")}},model:{value:a.cleanQuality.Tooth,callback:function(e){a.$set(a.cleanQuality,"Tooth",e)},expression:"cleanQuality.Tooth"}})],1),t("el-table-column",{attrs:{prop:"",label:"器皿",width:"100"}},[t("el-input-number",{attrs:{min:0,max:999,controls:!1},on:{change:function(e,t){a.handleNumberChange(e,t,"Ware")}},model:{value:a.cleanQuality.Ware,callback:function(e){a.$set(a.cleanQuality,"Ware",e)},expression:"cleanQuality.Ware"}})],1)],1),t("el-table-column",[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"mainTitle"},[a._v("\n            清洗质量\n          ")])]),t("el-table-column",{attrs:{prop:"",label:"血渍",width:"100"}},[t("el-input-number",{attrs:{controls:!1,min:0,max:999},on:{change:function(e,t){a.handleNumberChange(e,t,"BloodStain")}},model:{value:a.cleanQuality.BloodStain,callback:function(e){a.$set(a.cleanQuality,"BloodStain",e)},expression:"cleanQuality.BloodStain"}})],1),t("el-table-column",{attrs:{prop:"",label:"污渍",width:"100"}},[t("el-input-number",{attrs:{controls:!1,min:0,max:999},on:{change:function(e,t){a.handleNumberChange(e,t,"Stains")}},model:{value:a.cleanQuality.Stains,callback:function(e){a.$set(a.cleanQuality,"Stains",e)},expression:"cleanQuality.Stains"}})],1),t("el-table-column",{attrs:{prop:"",label:"锈迹",width:"100"}},[t("el-input-number",{attrs:{controls:!1,min:0,max:999},on:{change:function(e,t){a.handleNumberChange(e,t,"RustStain")}},model:{value:a.cleanQuality.RustStain,callback:function(e){a.$set(a.cleanQuality,"RustStain",e)},expression:"cleanQuality.RustStain"}})],1)],1)],1),t("p",[t("el-button",{staticClass:"btn88x32empty",on:{click:a.cancel}},[a._v("取消")]),t("el-button",{staticClass:"btn88x32",attrs:{type:"primary"},on:{click:a.comfirm}},[a._v("确认")])],1)],1)])},c=[],o={data:function(){return{cleanQuality:{BloodStain:0,Joint:0,RustStain:0,Stains:0,Surface:0,Tooth:0,Ware:0}}},props:["data","carrierIndex","packageIndex","instrumentIndex","maxNum"],created:function(){this.cleanQuality=Object.assign({},this.$props.data)},methods:{cancel:function(){this.$emit("UnqualifiedInstruments-to-father")},comfirm:function(){this.cleanQuality.Surface+this.cleanQuality.Joint+this.cleanQuality.Tooth+this.cleanQuality.Ware>this.$props.maxNum||this.cleanQuality.BloodStain+this.cleanQuality.Stains+this.cleanQuality.RustStain>this.$props.maxNum||this.cleanQuality.Surface+this.cleanQuality.Joint+this.cleanQuality.Tooth+this.cleanQuality.Ware!=this.cleanQuality.BloodStain+this.cleanQuality.Stains+this.cleanQuality.RustStain?this.showInformation({classify:"message",msg:"<div style='text-align:center;'>填写数字有误！请重新填写！</br>“器械及器皿数”=“清洗质量数”≤“器械总数”</div>",dangerouslyUseHTMLString:!0}):this.$emit("UnqualifiedInstruments-to-father",{data:this.cleanQuality,carrierIndex:this.$props.carrierIndex,packageIndex:this.$props.packageIndex,instrumentIndex:this.$props.instrumentIndex})},handleNumberChange:function(a,e,t){var n=this;void 0==a&&setTimeout(function(){n.cleanQuality[t]=0},0)}}},u=o,d=(t("1a4b"),t("2877")),m=Object(d["a"])(u,r,c,!1,null,null,null),h=m.exports,p={data:function(){return{isShowUnqualifiedInstruments:!1,carrierList:[],cleanQuality:{},carrier_index:0,package_index:0,instrument_index:0,max_num:0}},props:["failedCarriers","taskId"],components:{UnqualifiedInstruments:h},created:function(){var a=this;""==this.$props.failedCarriers?this.$props.taskId&&axios({url:"/api/Clean/CleanCarriers/".concat(this.$props.taskId)}).then(function(e){200==e.data.Code?a.carrierList=e.data.Data:a.showInformation({classify:"message",msg:e.data.Msg})}).catch(function(a){}):this.carrierList=this.$props.failedCarriers.concat([])},methods:{saveData:function(){this.$emit("cleanFailed-to-father",this.carrierList)},cancel:function(){this.$emit("cleanFailed-to-father")},editCleanQuality:function(a,e,t){this.cleanQuality=this.carrierList[a].Packages[e].Instruments[t].FailedInstrumentForClean.CleanInstrumentRecord,this.carrier_index=a,this.package_index=e,this.instrument_index=t,this.max_num=this.carrierList[a].Packages[e].OriginalQuantity*this.carrierList[a].Packages[e].Instruments[t].InstrumentCount,this.isShowUnqualifiedInstruments=!0},UnqualifiedInstruments:function(a){if(this.isShowUnqualifiedInstruments=!1,a){this.carrierList[a.carrierIndex].Packages[a.packageIndex].Instruments[a.instrumentIndex].FailedInstrumentForClean.CleanInstrumentRecord=Object.assign({},a.data),this.carrierList[a.carrierIndex].Packages[a.packageIndex].Instruments[a.instrumentIndex].FailedInstrumentCount=a.data.BloodStain+a.data.Stains+a.data.RustStain;var e=0;this.carrierList[a.carrierIndex].Packages[a.packageIndex].Instruments.forEach(function(a){Math.ceil(a.FailedInstrumentCount/a.InstrumentCount)>e&&(e=Math.ceil(a.FailedInstrumentCount/a.InstrumentCount))}),this.carrierList[a.carrierIndex].Packages[a.packageIndex].CanNotBePackagedCount=e}},handelNumberChange:function(a,e,t){void 0==a&&setTimeout(function(){t.CanNotBePackagedCount=0},0)}}},C=p,v=(t("6a8b"),Object(d["a"])(C,s,l,!1,null,null,null)),f=v.exports,g={data:function(){return{taskIndex:0,taskId:0,failedCarrier:[],isShowCleanView:!0,isShowCarrierList:!1,isShowCleanFailedPackages:!1,cleanTask:{CleanCleaningTasks:[],CleanPendingReviewTasks:[]}}},components:{CleanFailedPackages:f},created:function(){var a=this;axios({url:"/api/Clean/CleanReview"}).then(function(e){200==e.data.Code?(a.cleanTask=e.data.Data,a.cleanTask.CleanCleaningTasks&&a.cleanTask.CleanCleaningTasks.forEach(function(e,t){e["Countdown"+t]=setInterval(function(){e.RemainingTime--,e.RemainingTime<=0&&(clearInterval(e["Countdown"+t]),a.$router.go(0))},1e3)})):a.showInformation({classify:"message",msg:e.data.Msg})}).catch(function(a){})},beforeDestroy:function(){this.cleanTask.CleanCleaningTasks&&this.cleanTask.CleanCleaningTasks.forEach(function(a,e){clearInterval(a["Countdown"+e])})},mounted:function(){$(".cssd_table_subTabs").on("click","dt.reviewStatus",function(){$(this).siblings().stop().slideToggle("fast").end().parent().toggleClass("isActive").siblings().removeClass("isActive").find("dd").stop().slideUp("fast")})},methods:{goBack:function(){this.$router.go(-1)},handleNumberChange:function(a,e,t,n){var i=this;void 0==a&&setTimeout(function(){i.cleanTask.CleanPendingReviewTasks[n].CleaningQualityRecord[t]=0},0)},submitCheckResult:function(a){var e=this;(4!=this.cleanTask.CleanPendingReviewTasks[a].CleanReviewResult||this.GLOBAL.VerificationHandle([{val:this.cleanTask.CleanPendingReviewTasks[a].FailedPackageNumber,type:"NumberNotZero",msg:"您的审核结果为部分不合格！请至少添加一个不合格包！"}]))&&axios({url:"/api/Clean/CleanReviewSubmit",method:"POST",data:this.cleanTask.CleanPendingReviewTasks[a]}).then(function(a){var t;200==a.data.Code?(t="success",e.$router.go(0)):t="error",e.showInformation({classify:"message",msg:a.data.Msg,type:t})}).catch(function(a){})},cleanFailedToFather:function(a){this.isShowCleanFailedPackages=!1,this.isShowCleanView=!0,a&&(this.cleanTask.CleanPendingReviewTasks[this.taskIndex].FailedCarriers=a)},handleFailedPackages:function(a){this.taskIndex=a,this.taskId=this.cleanTask.CleanPendingReviewTasks[a].CleanTaskId,this.failedCarrier=this.cleanTask.CleanPendingReviewTasks[a].FailedCarriers,this.isShowCleanView=!1,this.isShowCleanFailedPackages=!0},resetDeviceTime:function(a){var e=this;axios({url:"/api/Clean/ReturnDeviceTimeToZero/".concat(this.cleanTask.CleanCleaningTasks[a].CleanDeviceId)}).then(function(a){var t;200==a.data.Code?(t="success",e.$router.go(0)):t="error",e.showInformation({classify:"message",msg:a.data.Msg,type:t})}).catch(function(a){})}},computed:{timeFormatDuring:function(){return function(a){var e=parseInt(a%86400/3600),t=parseInt(a%3600/60),n=a%60;return e=e<10?"0"+e:e,t=t<10?"0"+t:t,n=n<10?"0"+n:n,e+":"+t+":"+n}},countFailedPackageNumber:function(){var a=this;return function(e){for(var t=a.cleanTask.CleanPendingReviewTasks[e].FailedCarriers,n=0,i=0;i<t.length;i++)for(var s=0;s<t[i].Packages.length;s++)n+=t[i].Packages[s].CanNotBePackagedCount;return a.cleanTask.CleanPendingReviewTasks[e].FailedPackageNumber=n,n}}}},_=g,b=(t("329a"),Object(d["a"])(_,n,i,!1,null,null,null));e["default"]=b.exports},6883:function(a,e,t){},"6a8b":function(a,e,t){"use strict";var n=t("d141"),i=t.n(n);i.a},ac6a:function(a,e,t){for(var n=t("cadf"),i=t("0d58"),s=t("2aba"),l=t("7726"),r=t("32e9"),c=t("84f2"),o=t("2b4c"),u=o("iterator"),d=o("toStringTag"),m=c.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(h),C=0;C<p.length;C++){var v,f=p[C],g=h[f],_=l[f],b=_&&_.prototype;if(b&&(b[u]||r(b,u,m),b[d]||r(b,d,f),c[f]=m,g))for(v in n)b[v]||s(b,v,n[v],!0)}},d141:function(a,e,t){}}]);