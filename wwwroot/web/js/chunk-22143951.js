(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22143951"],{"1a10":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"photoView"}},[e("div",{staticClass:"container"},[e("div",{staticClass:"view_menu"},[t.$props.viewMode?t._e():e("h3",[e("p",{on:{click:t.switchToTakePhoto}})]),e("el-tabs",{attrs:{type:"card","tab-position":"left"},on:{"tab-click":t.tabClicked},model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},t._l(t.list,function(a,i){return e("el-tab-pane",{key:i,attrs:{name:i+""}},[e("div",{staticClass:"imageListBox",attrs:{slot:"label"},slot:"label"},[e("img",{attrs:{src:a.Path||a.Base64String,alt:""}}),t.$props.viewMode?t._e():e("i",{staticClass:"deleteImg",on:{click:function(a){return a.stopPropagation(),t.deleteImg(i)}}})]),e("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:0==t.mode,expression:"mode==0"}],staticClass:"tab_content"},[e("img",{attrs:{src:a.Path||a.Base64String,alt:""}}),t.$props.viewMode?t._e():e("el-input",{attrs:{type:"textarea",placeholder:"备注",resize:"none"},model:{value:a.Remark,callback:function(e){t.$set(a,"Remark","string"===typeof e?e.trim():e)},expression:"item.Remark"}}),t.$props.viewMode?e("p",[t._v(t._s(a.Remark))]):t._e()],1)])],1)}),1)],1),e("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:1===t.mode,expression:"mode===1"}],staticClass:"view_content"},[e("img",{attrs:{src:t.image,alt:""}}),e("h5",[e("el-button",{staticClass:"btn120x40",on:{click:t.takePhoto}},[t._v("拍照")])],1)])]),e("i",{staticClass:"closePhotoView",on:{click:t.close}})],1)])},s=[],n={props:["data","viewMode","DeletedPicturesId"],data:function(){return{activeName:"-1",mode:0,image:"",list:[]}},created:function(){this.list=null==this.$props.data?[]:this.$props.data,this.list.length>0&&(this.activeName=0),this.$props.viewMode||this.switchToTakePhoto()},beforeDestroy:function(){CSManager.CloseVideo()},methods:{close:function(){this.$emit("viewPhoto-to-father",this.list)},switchToTakePhoto:function(){this.$props.viewMode||CSManager.OpenVideo(50,"",this),this.mode=1},takePhoto:function(){this.list.push({Id:0,Path:"",Base64String:this.image,Remark:""}),this.mode=0,this.activeName=this.list.length-1+""},deleteImg:function(t){var a=this;this.$confirm("您确定要删除该照片?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){0!=a.list[t].Id&&a.$props.DeletedPicturesId.push(a.list[t].Id),a.list.splice(t,1)}).catch(function(){})},tabClicked:function(){this.mode=0}}},o=n,r=(e("68c0"),e("2877")),c=Object(r["a"])(o,i,s,!1,null,null,null);a["a"]=c.exports},"68c0":function(t,a,e){"use strict";var i=e("c38f"),s=e.n(i);s.a},9460:function(t,a,e){},a58d:function(t,a,e){"use strict";var i=e("d18a"),s=e.n(i);s.a},ac6a:function(t,a,e){for(var i=e("cadf"),s=e("0d58"),n=e("2aba"),o=e("7726"),r=e("32e9"),c=e("84f2"),l=e("2b4c"),d=l("iterator"),u=l("toStringTag"),h=c.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=s(p),m=0;m<f.length;m++){var g,v=f[m],k=p[v],_=o[v],w=_&&_.prototype;if(w&&(w[d]||r(w,d,h),w[u]||r(w,u,v),c[v]=h,k))for(g in i)w[g]||n(w,g,i[g],!0)}},c38f:function(t,a,e){},c948:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"cssd_box",attrs:{id:"unqualifiedPackageRegistration"}},[e("div",{staticClass:"cssd_title"},[e("ul",{staticClass:"cssd_menu"},[e("li",{on:{click:t.goBack}},[e("p",[t._v("返回")])]),e("li",{on:{click:t.handleShowManualEnter}},[e("p",[t._v("手工录入")])]),t.isChangeMode?t._e():e("router-link",{attrs:{to:"/apply/unqualifiedRecord",tag:"li"}},[e("p",[t._v("登记记录")])])],1)]),e("div",{staticClass:"cssd_table_center cssd_totalBar table_unExpand"},[e("div",{staticClass:"table_box"},[e("el-table",{attrs:{data:t.packages.FailedPackages}},[e("el-table-column",{attrs:{label:"包条码",prop:"BarCode",width:"240"}}),e("el-table-column",{attrs:{label:"包名称",prop:"ProductName",width:"210"}}),e("el-table-column",{attrs:{label:"不合格原因",width:"210"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-select",{staticClass:"green18x10",model:{value:a.row.FailedPackageCause,callback:function(e){t.$set(a.row,"FailedPackageCause",e)},expression:"props.row.FailedPackageCause"}},[e("el-option",{attrs:{label:"包内卡不合格",value:0,width:"210"}}),e("el-option",{attrs:{label:"湿包",value:1}})],1)]}}])}),e("el-table-column",{attrs:{label:"照片",width:"210"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("a",{on:{click:function(e){return t.handleShowPhotos(a.$index)}}},[t._v("拍照")])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"210"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{on:{click:function(e){return t.deletePackage(a.$index)}}},[t._v("删除")])]}}])}),e("el-table-column")],1)],1),e("div",{staticClass:"cssd_table_bottom"},[e("p",[t._v("\n        共计\n        "),e("span",[t._v(t._s(t.countPackageNumber(t.packages.FailedPackages)))]),t._v(" 包\n      ")]),e("p",[t.isChangeMode?e("el-button",{on:{click:t.cancelChange}},[t._v("取消修改")]):t._e(),e("el-button",{attrs:{type:"primary"},on:{click:t.registrationComplete}},[t._v(t._s(t.isChangeMode?"修改完成":"登记完成"))])],1)])]),e("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[t.isShowManualEnter?e("ManualEnter",{attrs:{BarCodeList:t.packages.FailedPackages,ApiUrl:"/api/Scanner/Apply"},on:{"to-father":t.packageData2father}}):t._e()],1),e("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[t.isShowPhoto?e("PhotoView",{attrs:{data:t.photoData,DeletedPicturesId:t.deleteIds},on:{"viewPhoto-to-father":t.viewPhotoToFather}}):t._e()],1)],1)},s=[],n=(e("ac6a"),e("d040")),o=e("1a10"),r={data:function(){return{deleteIds:[],isShowPhoto:!1,isShowManualEnter:!1,isChangeMode:!1,photoData:[],packages:{FailedPackages:[]}}},components:{ManualEnter:n["a"],PhotoView:o["a"]},created:function(){var t=this;CSManager.handleDataThis=this,this.$route.query.recordId&&(this.isChangeMode=!0,axios({url:"/api/FailedPackage/PendingUpdatePackagesBy/".concat(this.$route.query.recordId)}).then(function(a){200==a.data.Code?t.packages=a.data.Data:t.showInformation({classify:"message",msg:a.data.Msg})}).catch(function(t){}))},mounted:function(){},beforeDestroy:function(){CSManager.handleDataThis=null},methods:{viewPhotoToFather:function(){this.isShowPhoto=!1},handleShowPhotos:function(t){this.photoData=this.packages.FailedPackages[t].FailedPackagePictures,this.deleteIds=this.packages.FailedPackages[t].DeletedPicturesId,this.isShowPhoto=!0},goBack:function(){this.isChangeMode?this.$router.push("/apply/unqualifiedRecord"):this.$router.push("/")},cancelChange:function(){this.$router.push("/apply/unqualifiedRecord")},deletePackage:function(t){this.packages.FailedPackages.splice(t,1)},registrationComplete:function(){var t=this,a="POST",e="/api/FailedPackage/FailedPackageRegister";this.isChangeMode&&(a="PUT",e="/api/FailedPackage/FailedPackageModify"),this.GLOBAL.VerificationHandle([{val:this.packages.FailedPackages,type:"ArrayNotEmpty",msg:"您还没有录入不合格包，请至少添加一个不合格包！"}])&&axios({url:e,method:a,data:this.packages}).then(function(a){var e;200==a.data.Code?(e="success",t.isChangeMode?t.$router.push("/apply/unqualifiedRecord"):t.$router.go(0)):e="error",t.showInformation({classify:"message",msg:a.data.Msg,type:e})}).catch(function(t){})},handleShowManualEnter:function(){this.isShowManualEnter=!0},packageData2father:function(t){this.isShowManualEnter=!1,t&&(t.FailedPackageCause=0,this.packages.FailedPackages.push(t))},handleBarCode:function(t){var a=this,e=!0;this.packages.FailedPackages.forEach(function(i){if(i.BarCode==t.toUpperCase())return a.showInformation({classify:"message",msg:"该条码已录入！",type:"warning"}),void(e=!1)}),e&&axios({url:"/api/Scanner/Apply/".concat(t)}).then(function(t){200==t.data.Code?a.packageData2father(t.data.Data):a.showInformation({classify:"message",msg:t.data.Msg})}).catch(function(t){})}},computed:{countPackageNumber:function(){return function(t){return t.length}}}},c=r,l=(e("a58d"),e("2877")),d=Object(l["a"])(c,i,s,!1,null,null,null);a["default"]=d.exports},d040:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"manual_enter"}},[e("dl",[e("dt",[e("el-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{placeholder:"请扫描或手动录入条码"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.SaveOption(a)}},model:{value:t.input_str,callback:function(a){t.input_str="string"===typeof a?a.trim():a},expression:"input_str"}})],1),e("dd",[e("el-button",{on:{click:t.cancelOption}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.SaveOption}},[t._v("确定")])],1)])])},s=[],n=(e("ac6a"),{props:["BarCodeList","ApiUrl","task_index","firstRequest"],data:function(){return{input_str:""}},created:function(){},mounted:function(){},methods:{cancelOption:function(){this.$emit("to-father","")},SaveOption:function(){var t=this;this.GLOBAL.VerificationHandle([{val:this.input_str,type:"StringNotEmpty",msg:"扫描条码不能为空！"}])&&(this.$props.firstRequest?axios("".concat(this.$props.ApiUrl,"/").concat(this.input_str)).then(function(a){if(200==a.data.Code)if(t.$props.task_index>=0)t.$emit("to-father",{data:a.data.Data,index:t.$props.task_index});else{if(a.data.Data.PackageBarCodeScannerVm)for(var e=0;e<t.$props.BarCodeList.length;e++)if(t.$props.BarCodeList[e].BarCode==a.data.Data.PackageBarCodeScannerVm.BarCode)return t.showInformation({classify:"message",msg:"该条码已录入！",type:"warning"}),void(t.input_str="");t.$emit("to-father",a.data.Data,t.input_str)}else 300==a.data.Code?(t.input_str="",t.showInformation({classify:"message",msg:a.data.Msg,type:"warning"})):(t.input_str="",t.showInformation({classify:"message",msg:a.data.Msg,type:"error"}))}).catch(function(t){}):(this.$props.BarCodeList.forEach(function(a){if(a.BarCode==t.input_str.toUpperCase())return t.showInformation({classify:"message",msg:"该条码已录入！",type:"warning"}),void(t.input_str="")}),axios("".concat(this.$props.ApiUrl,"/").concat(this.input_str)).then(function(a){200==a.data.Code?t.$props.task_index>=0?t.$emit("to-father",{data:a.data.Data,index:t.$props.task_index}):t.$emit("to-father",a.data.Data,t.input_str):300==a.data.Code?(t.input_str="",t.showInformation({classify:"message",msg:a.data.Msg,type:"warning"})):(t.input_str="",t.showInformation({classify:"message",msg:a.data.Msg,type:"error"}))}).catch(function(t){})))}}}),o=n,r=(e("dda8"),e("2877")),c=Object(r["a"])(o,i,s,!1,null,null,null);a["a"]=c.exports},d18a:function(t,a,e){},dda8:function(t,a,e){"use strict";var i=e("9460"),s=e.n(i);s.a}}]);