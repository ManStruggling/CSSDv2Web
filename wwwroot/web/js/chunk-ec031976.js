(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ec031976"],{"3cff":function(t,e,a){"use strict";var i=a("824f"),n=a.n(i);n.a},5118:function(t,e,a){(function(t){var i="undefined"!==typeof t&&t||"undefined"!==typeof self&&self||window,n=Function.prototype.apply;function r(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new r(n.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new r(n.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},a("6017"),e.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof t&&t.clearImmediate||this&&this.clearImmediate}).call(this,a("c8ba"))},6017:function(t,e,a){(function(t,e){(function(t,a){"use strict";if(!t.setImmediate){var i,n=1,r={},s=!1,o=t.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(t);c=c&&c.setTimeout?c:t,"[object process]"==={}.toString.call(t.process)?h():p()?g():t.MessageChannel?m():o&&"onreadystatechange"in o.createElement("script")?v():y(),c.setImmediate=l,c.clearImmediate=d}function l(t){"function"!==typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),a=0;a<e.length;a++)e[a]=arguments[a+1];var s={callback:t,args:e};return r[n]=s,i(n),n++}function d(t){delete r[t]}function u(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(a,i);break}}function f(t){if(s)setTimeout(f,0,t);else{var e=r[t];if(e){s=!0;try{u(e)}finally{d(t),s=!1}}}}function h(){i=function(t){e.nextTick(function(){f(t)})}}function p(){if(t.postMessage&&!t.importScripts){var e=!0,a=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=a,e}}function g(){var e="setImmediate$"+Math.random()+"$",a=function(a){a.source===t&&"string"===typeof a.data&&0===a.data.indexOf(e)&&f(+a.data.slice(e.length))};t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),i=function(a){t.postMessage(e+a,"*")}}function m(){var t=new MessageChannel;t.port1.onmessage=function(t){var e=t.data;f(e)},i=function(e){t.port2.postMessage(e)}}function v(){var t=o.documentElement;i=function(e){var a=o.createElement("script");a.onreadystatechange=function(){f(e),a.onreadystatechange=null,t.removeChild(a),a=null},t.appendChild(a)}}function y(){i=function(t){setTimeout(f,0,t)}}})("undefined"===typeof self?"undefined"===typeof t?this:t:self)}).call(this,a("c8ba"),a("f28c"))},"6ef6":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"basic_main"},[a("div",{staticClass:"basic_main_head"},[a("p"),a("el-button",{staticClass:"basic_ipt_add",attrs:{type:"primary"},on:{click:t.addTableTr}},[t._v("新增报表")])],1),a("div",{staticClass:"basic_table table_unExpand"},[a("el-table",{attrs:{data:t.table_data}},[a("el-table-column",{attrs:{label:"报表名称",prop:"ReportName",width:"240"}}),a("el-table-column",{attrs:{label:"操作",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"change_this_tr",on:{click:function(a){return a.stopPropagation(),t.editThisTr(e.$index)}}},[t._v("编辑")]),a("a",{staticClass:"delete_this_tr",on:{click:function(a){return a.stopPropagation(),t.deleteThisTr(e.$index)}}},[t._v("删除")])]}}])}),a("el-table-column")],1)],1),a("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[t.showEditBox?a("ReportFormBox",{attrs:{toChildReportId:t.toChildReportId},on:{"to-father":t.child2father}}):t._e()],1)],1)},n=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"EditBoxReportFormBox",attrs:{id:"editBox"}},[a("div",{staticClass:"editContainer"},[a("div",{staticClass:"editContent"},[a("ul",{staticClass:"clear_float"},[a("li",[a("p",[t._v("报表名称")]),a("el-input",{attrs:{type:"text",placeholder:"报表名称"},model:{value:t.editBoxData.ReportName,callback:function(e){t.$set(t.editBoxData,"ReportName","string"===typeof e?e.trim():e)},expression:"editBoxData.ReportName"}})],1),a("li",[a("p",[t._v("报表类型")]),a("el-select",{staticClass:"green24x13",on:{change:t.reportTypeChange},model:{value:t.ReportType,callback:function(e){t.ReportType=e},expression:"ReportType"}},t._l(t.allKeys,function(t,e){return a("el-option",{key:e,attrs:{label:t.DisplayName,value:t.MainReportId}})}),1)],1)]),a("div",{staticClass:"multiSelectBox"},[a("DraggableTransfer",{ref:"transferBox",attrs:{sourceLeft:t.keyList,targetRight:t.editBoxData.MainReport.Parameters},on:{"transfer-to-father":t.transferToFather}})],1)]),a("div",{staticClass:"editBoxOption"},[a("el-button",{on:{click:t.editBoxCancelSave}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.editBoxSave}},[t._v("完成")])],1)])])},s=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"transferBox"}},[a("div",{staticClass:"box"},[a("div",{staticClass:"title"},[a("span",{class:{active:t.leftSelect===t.data1.length},on:{click:function(e){return t.selectAll(t.data1)}}},[t._v("未选报表参数")]),a("span",[t._v(t._s(t.leftSelect?t.leftSelect:0)+"/"+t._s(t.data1.length))])]),a("div",{staticClass:"left",on:{drop:function(e){return t.dropPub(e,2)},dragover:function(t){t.preventDefault()}}},t._l(t.changeSourceData,function(e,i){return a("div",{key:i,staticClass:"hover-color",class:{active:e.IsSelect},attrs:{draggable:"true"},on:{drag:t.ondrag,dragstart:function(a){return t.dragstart(a,e)},dragend:t.dragend,click:function(a){return t.hanldleClick(t.data1,e.Id)}}},[t._v(t._s(e.DisplayName))])}),0)]),a("div",{staticClass:"middle"},[a("div",{class:{active:t.rightSelect>0},on:{click:function(e){return t.moveItem(t.data2,t.data1)}}},[a("i",{staticClass:"el-icon-arrow-left"})]),a("div",{class:{active:t.leftSelect>0},on:{click:function(e){return t.moveItem(t.data1,t.data2)}}},[a("i",{staticClass:"el-icon-arrow-right"})])]),a("div",{staticClass:"box"},[a("div",{staticClass:"title"},[a("span",{class:{active:t.rightSelect===t.data2.length},on:{click:function(e){return t.selectAll(t.data2)}}},[t._v("已选报表参数")]),a("span",[t._v(t._s(t.rightSelect?t.rightSelect:0)+"/"+t._s(t.data2.length))])]),a("div",{staticClass:"right",on:{drop:function(e){return t.dropPub(e,1)},dragover:function(t){t.preventDefault()}}},t._l(t.changeTargetData,function(e,i){return a("div",{key:i,staticClass:"hover-color",class:{active:e.IsSelect},attrs:{draggable:"true"},on:{drag:t.ondrag,dragstart:function(a){return t.dragstart(a,e)},dragend:t.dragend,click:function(a){return t.hanldleClick(t.data2,e.Id)}}},[t._v(t._s(e.DisplayName))])}),0)])])},c=[],l=(a("ac6a"),a("5118"),{props:{sourceLeft:{type:Array},targetRight:{type:Array}},data:function(){return{data1:[],data2:[],target:{x:"",y:"",Id:""},changeSourceData:[],changeTargetData:[]}},created:function(){var t=this;this.sourceLeft.forEach(function(e){t.data1.push({Id:e.Id,DisplayName:e.DisplayName,IsSelect:!1,SpliceName:e.SpliceName,Type:e.Type,UrlString:e.UrlString})}),this.changeSourceData=this.data1,this.changeTargetData=this.data2},mounted:function(){var t=[];this.targetRight.length>0&&(this.targetRight.forEach(function(e){t.push({Id:e.Id,DisplayName:e.DisplayName,IsSelect:!1,SpliceName:e.SpliceName,Type:e.Type,UrlString:e.UrlString})}),this.data2=t,this.changeTargetData=t)},watch:{sourceLeft:function(){var t=this;this.data1=[],this.sourceLeft.forEach(function(e){t.data1.push({Id:e.Id,SpliceName:e.SpliceName,DisplayName:e.DisplayName,IsSelect:!1,Type:e.Type,UrlString:e.UrlString})}),this.changeSourceData=this.data1,this.changeTargetData=this.data2},value:function(){var t=this;this.value.length>0&&this.value.forEach(function(e){t.data1.forEach(function(a,i){e==a.Id&&t.data1.splice(i,1)})})},targetRight:function(){var t=[];this.targetRight.length>0&&(this.targetRight.forEach(function(e){t.push({Id:e.Id,DisplayName:e.DisplayName,IsSelect:!1,SpliceName:e.SpliceName,Type:e.Type,UrlString:e.UrlString})}),this.data2=t,this.changeTargetData=t)}},methods:{ondrag:function(t){this.target.y=t.y,this.target.x=t.x},dropPub:function(t,e){1==e?this.drop(t,this.data1,this.data2,e):this.drop(t,this.data2,this.data1,e)},drop:function(t,e,a,i){var n=t.dataTransfer.getData("Id");e.forEach(function(t,i){if(t.Id==n){var r=e.splice(i,1);r[0].IsSelect=!1,a.push(r[0])}}),this.resort(t,a,i)},resort:function(t,e,a){var i=t.currentTarget.children,n=[];if(1==a&&(e.forEach(function(t){n.push(t.Id)}),this.$emit("input",n)),2==a){var r=t.dataTransfer.getData("Id");this.changeTargetData.forEach(function(t){t.Id!=r&&n.push(t.Id)}),this.$emit("input",n)}for(var s=0;s<e.length;s++)e[s].Id==this.target.Id?e[s].y=this.target.y:e[s].y=i[s].getBoundingClientRect().y;for(var o=0;o<e.length-1;o++)for(var c=0;c<e.length-o-1;c++)if(e[c].y>e[c+1].y){var l=e[c];e[c]=e[c+1],e[c+1]=l}this.$forceUpdate()},dragstart:function(t,e){this.target.Id=e.Id,t.dataTransfer.setData("Id",e.Id)},dragend:function(t){t.dataTransfer.clearData(),this.$emit("transfer-to-father",this.changeTargetData)},hanldleClick:function(t,e){t.forEach(function(t){t.Id==e&&(t.IsSelect=!t.IsSelect)})},moveItem:function(t,e){var a=t.filter(function(t){return 1==t.IsSelect});if(a.length<=0)return!1;a.forEach(function(a){var i=t.indexOf(a);t.splice(i,1),a.IsSelect=!1,e.push(a)}),this.$emit("transfer-to-father",this.changeTargetData)},selectAll:function(t){var e=t.every(function(t){return 1==t.IsSelect});t.forEach(function(t){t.IsSelect=!e})}},computed:{leftSelect:function(){if(0===this.data1.length)return!1;var t=this.data1.filter(function(t){return 1==t.IsSelect});return t.length},rightSelect:function(){if(0==this.data2.length)return!1;var t=this.data2.filter(function(t){return 1==t.IsSelect});return t.length}}}),d=l,u=(a("e55b"),a("2877")),f=Object(u["a"])(d,o,c,!1,null,null,null),h=f.exports,p={props:["toChildReportId"],data:function(){return{editBoxData:{ReportId:0,ReportName:"",ReportUrl:"",MainReport:{MainReportId:0,UrlString:"",DisplayName:"",Parameters:[]}},allKeys:[],ReportType:"",keyList:[]}},components:{DraggableTransfer:h},created:function(){var t=this;0===this.$props.toChildReportId?axios({url:"/api/Report/NewReportParameter"}).then(function(e){200==e.data.Code?t.allKeys=e.data.Data.MainReports:t.showInformation({classify:"message",msg:e.data.Msg})}).catch(function(t){}):axios({url:"/api/Report/EditReport/".concat(this.$props.toChildReportId)}).then(function(e){if(200==e.data.Code){t.editBoxData.ReportId=e.data.Data.ReportId,t.editBoxData.ReportName=e.data.Data.ReportName,t.editBoxData.ReportUrl=e.data.Data.ReportUrl,t.allKeys=e.data.Data.NewReportParameter.MainReports,t.ReportType=e.data.Data.MainReport.MainReportId,t.reportTypeChange(t.ReportType),t.editBoxData.MainReport=e.data.Data.MainReport;for(var a=0;a<t.editBoxData.MainReport.Parameters.length;a++)for(var i=0;i<t.keyList.length;i++)if(t.editBoxData.MainReport.Parameters[a].Id==t.keyList[i].Id){t.keyList.splice(i,1);break}}else t.showInformation({classify:"message",msg:e.data.Msg})}).catch(function(t){})},mounted:function(){$("#editBox.EditBoxReportFormBox h3 .el-select .el-input__inner").val("选择报表参数")},methods:{transferToFather:function(t){this.editBoxData.MainReport.Parameters=t},reportTypeChange:function(t){for(var e=0;e<this.allKeys.length;e++)if(t===this.allKeys[e].MainReportId){this.keyList=this.allKeys[e].Parameters.concat([]),this.editBoxData.MainReport={DisplayName:this.allKeys[e].DisplayName,MainReportId:this.allKeys[e].MainReportId,UrlString:this.allKeys[e].UrlString,Parameters:[]};break}this.$refs.transferBox.data2=[],this.$refs.transferBox.changeTargetData=[]},editBoxCancelSave:function(){this.$emit("to-father","")},editBoxSave:function(){var t=this,e="";if(e=0==this.editBoxData.ReportId?"post":"put",this.GLOBAL.VerificationHandle([{val:this.editBoxData.ReportName,type:"StringNotEmpty",msg:"报表名称不能为空！"},{val:this.editBoxData.MainReport.Parameters,type:"ArrayNotEmpty",msg:"您还没有选择报表参数,请选择报表参数！"}])){this.editBoxData.ReportUrl="";for(var a="",i="",n="",r=0;r<this.allKeys.length;r++)if(this.ReportType===this.allKeys[r].MainReportId){a="/odata/".concat(this.allKeys[r].UrlString,"?");break}for(var s=0;s<this.editBoxData.MainReport.Parameters.length;s++)for(var o=0;o<this.keyList.length;o++)this.editBoxData.MainReport.Parameters[s]===this.keyList[o].Id&&(0===this.keyList[o].Type?i=i+this.keyList[o].UrlString+",":n=n+this.keyList[o].UrlString+",",this.editBoxData.MainReport.Parameters[s]=this.keyList[o]);n&&(n="&$expand="+n.substr(0,n.length-1)),i&&(i="$select="+i.substr(0,i.length-1)),this.editBoxData.ReportUrl=a+i+n,axios({url:"/api/Report",method:e,data:this.editBoxData}).then(function(e){var a;200==e.data.Code?(a="success",t.$emit("to-father",e.data.Data)):a="error",t.showInformation({classify:"message",msg:e.data.Msg,type:a})}).catch(function(t){})}}}},g=p,m=(a("3cff"),Object(u["a"])(g,r,s,!1,null,null,null)),v=m.exports,y={data:function(){return{table_data:[],showEditBox:!1,toChildReportId:0}},components:{ReportFormBox:v},created:function(){var t=this;axios({url:"/api/Report"}).then(function(e){200==e.data.Code?t.table_data=e.data.Data:t.showInformation({classify:"message",msg:e.data.Msg})}).catch(function(t){})},mounted:function(){},methods:{addTableTr:function(){this.toChildReportId=0,this.showEditBox=!0},editThisTr:function(t){this.toChildReportId=this.table_data[t].ReportId,this.showEditBox=!0},deleteThisTr:function(t){var e=this;this.$confirm("您是否确定删除该项?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){axios.delete("/api/Report/".concat(e.table_data[t].ReportId)).then(function(t){200==t.data.Code?e.table_data=t.data.Data:e.showInformation({classify:"message",msg:t.data.Msg})}).catch(function(t){})}).catch(function(){})},child2father:function(t){this.showEditBox=!1,t&&(this.table_data=t)}}},I=y,T=Object(u["a"])(I,i,n,!1,null,null,null);e["default"]=T.exports},"824f":function(t,e,a){},ac6a:function(t,e,a){for(var i=a("cadf"),n=a("0d58"),r=a("2aba"),s=a("7726"),o=a("32e9"),c=a("84f2"),l=a("2b4c"),d=l("iterator"),u=l("toStringTag"),f=c.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=n(h),g=0;g<p.length;g++){var m,v=p[g],y=h[v],I=s[v],T=I&&I.prototype;if(T&&(T[d]||o(T,d,f),T[u]||o(T,u,v),c[v]=f,y))for(m in i)T[m]||r(T,m,i[m],!0)}},cba6:function(t,e,a){},e55b:function(t,e,a){"use strict";var i=a("cba6"),n=a.n(i);n.a}}]);