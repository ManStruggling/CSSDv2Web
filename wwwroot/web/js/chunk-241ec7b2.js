(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-241ec7b2"],{"1d49":function(t,e,a){"use strict";var i=a("23c4"),s=a.n(i);s.a},"23c4":function(t,e,a){},"36d8":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cssd_box provideRecordChange"},[a("div",{staticClass:"cssd_title"},[a("ul",{staticClass:"cssd_menu"},[a("li",[a("router-link",{attrs:{to:"/provide/record",tag:"p"}},[t._v("返回")])],1),a("li",[a("p",{on:{click:t.handleShowManualEnter}},[t._v("手工录入")])]),t._m(0)])]),a("div",{staticClass:"cssd_table_center"},[a("div",{staticClass:"table_box"},[a("el-collapse",{attrs:{accordion:""},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.provideTaskList.ProvideTaskDetails,function(e,i){return a("el-collapse-item",{key:i,attrs:{name:i}},[a("div",{staticClass:"collapseTh",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"collapseTd"},[a("p",[t._v("包名称")]),a("p",[t._v(t._s(e.ProductName))])]),a("div",{staticClass:"collapseTd"},[a("p",[t._v("预计发放数")]),a("p",[t._v(t._s(e.ScheduledQuantity))])]),a("div",{staticClass:"collapseTd"},[a("p",[t._v("回收时间")]),a("p",[t._v(t._s(e.RecycleDate))])]),a("div",{staticClass:"collapseTd"},[a("p",[t._v("库存数")]),a("p",[t._v(t._s(e.InventoryQuantity))])]),a("div",{staticClass:"collapseTd"},[a("p",[t._v("剩余发放数")]),a("p",[t._v(t._s(e.RemainQuantity))])]),a("div",{staticClass:"collapseTd"},[a("p",[t._v("本次发放数")]),e.IsNotPrintBarCode?t._e():a("p",[t._v(t._s(t.countThisProvideNumber(e.ProvidePackages,i)))]),e.IsNotPrintBarCode?a("p",[a("el-input-number",{attrs:{min:0,max:e.MaxLimit=e.InventoryQuantity>e.RemainQuantity?e.RemainQuantity:e.InventoryQuantity,size:"mini"},on:{change:function(a,i){t.handleCountNumberPackage(a,i,t.provideTaskList.ProvideTaskDetails,e)}},nativeOn:{click:function(e){return e.stopPropagation(),t.GLOBAL.cancelBubble(e)}},model:{value:e.ThisTimeProvideQuantity,callback:function(a){t.$set(e,"ThisTimeProvideQuantity",a)},expression:"value.ThisTimeProvideQuantity"}})],1):t._e()])]),a("el-table",{staticStyle:{"text-align":"center"},attrs:{stripe:"","highlight-current-row":"",data:e.ProvidePackages}},[a("el-table-column",{attrs:{label:"包条码",prop:"BarCode"}}),a("el-table-column",{attrs:{label:"配包日期",prop:"PackageDate"}}),a("el-table-column",{attrs:{label:"有效日期",prop:"ValidDate"}}),a("el-table-column",{attrs:{label:"灭菌设备名称",prop:"SterilizeDevice"}}),a("el-table-column",{attrs:{label:"当日锅次",prop:"SterilizeTodayBatch"}}),a("el-table-column",{attrs:{label:"总锅次",prop:"SterilizeTotalBatch"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{on:{click:function(a){return t.deleteProvidePackage(i,e.$index)}}},[t._v("删除")])]}}],null,!0)})],1)],1)}),1)],1),a("div",{staticClass:"cssd_table_bottom"},[a("p",[t._v("\n        共计\n        "),a("span",[t._v(t._s(t.countPackageNumber(t.provideTaskList.ProvideTaskDetails)))]),t._v(" 包\n      ")]),a("p",[a("el-button",{on:{click:t.cancelChange}},[t._v("取消修改")]),a("el-button",{attrs:{type:"primary"},on:{click:t.changeSubmit}},[t._v("修改完成")])],1)])]),t.isShowManualEnter?a("ManualEnter",{attrs:{BarCodeList:t.barCodeList,ApiUrl:"/api/Scanner/IncludePackages/Provide"},on:{"to-father":t.packageData2father}}):t._e()],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",[a("p",[t._v("计数包发放")])])}],n=(a("ac6a"),a("d040")),r={data:function(){return{isShowManualEnter:!1,activeName:"0",provideTaskList:[],barCodeList:[],ThisClinicProvideNumber:0}},components:{ManualEnter:n["a"]},created:function(){var t=this;this.$route.query.recordId&&axios({url:"/api/Provide/PendingUpdateLogistics/".concat(this.$route.query.recordId)}).then(function(e){200==e.data.Code?t.provideTaskList=e.data.Data:t.showInformation({classify:"message",msg:e.data.Msg})}).catch(function(t){})},methods:{cancelChange:function(){this.$router.push({path:"/provide/record"})},changeSubmit:function(){var t=this;this.GLOBAL.VerificationHandle([{val:this.ThisClinicProvideNumber,type:"NumberNotZero",msg:"您还没有发放包，请至少添加一个包！"}])&&axios({url:"/api/Provide/ProvideModify",method:"PUT",data:this.provideTaskList}).then(function(e){var a;200==e.data.Code?(a="success",t.$router.push({path:"/provide/record"})):a="error",t.showInformation({classify:"message",msg:e.data.Msg,type:a})}).catch(function(t){})},deleteProvidePackage:function(t,e){this.provideTaskList.ProvideTaskDetails[t].ProvidePackages.splice(e,1)},packageData2father:function(t){var e=this;this.isShowManualEnter=!1,t&&t.forEach(function(t){e.handleAddData(t)})},handleShowManualEnter:function(){for(var t=[],e=0;e<this.provideTaskList.ProvideTaskDetails.length;e++)for(var a=0;a<this.provideTaskList.ProvideTaskDetails[e].ProvidePackages.length;a++)t.push(this.provideTaskList.ProvideTaskDetails[e].ProvidePackages[a]);this.barCodeList=t,this.isShowManualEnter=!0},handleAddData:function(t){for(var e=0;e<this.provideTaskList.ProvideTaskDetails.length;e++)if(this.provideTaskList.ProvideTaskDetails[e].ProductId==t.ProductId&&this.provideTaskList.ProvideTaskDetails[e].ThisTimeProvideQuantity<this.provideTaskList.ProvideTaskDetails[e].ScheduledQuantity)return void this.provideTaskList.ProvideTaskDetails[e].ProvidePackages.push(t)},handleCountNumberPackage:function(t,e,a,i){var s=this;setTimeout(function(){if(void 0==t)i.ThisTimeProvideQuantity=0;else{var n=0;a.forEach(function(t){i.ProductId==t.ProductId&&(n+=t.ThisTimeProvideQuantity)}),n>i.InventoryQuantity&&(i.ThisTimeProvideQuantity=e,s.showInformation({classify:"message",msg:"您所选的数量大于库存数！",type:"warning"}))}},0)}},computed:{countThisProvideNumber:function(){var t=this;return function(e,a){return t.provideTaskList.ProvideTaskDetails[a].ThisTimeProvideQuantity=e.length,e.length}},countPackageNumber:function(){var t=this;return function(e){var a=0;return e&&(e.forEach(function(t){a+=t.ProvidePackages.length}),t.ThisClinicProvideNumber=a),a}}}},o=r,c=(a("1d49"),a("2877")),l=Object(c["a"])(o,i,s,!1,null,null,null);e["default"]=l.exports},9460:function(t,e,a){},ac6a:function(t,e,a){for(var i=a("cadf"),s=a("0d58"),n=a("2aba"),r=a("7726"),o=a("32e9"),c=a("84f2"),l=a("2b4c"),d=l("iterator"),u=l("toStringTag"),p=c.Array,v={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=s(v),f=0;f<h.length;f++){var m,g=h[f],k=v[g],T=r[g],_=T&&T.prototype;if(_&&(_[d]||o(_,d,p),_[u]||o(_,u,g),c[g]=p,k))for(m in i)_[m]||n(_,m,i[m],!0)}},d040:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"manual_enter"}},[a("dl",[a("dt",[a("el-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{placeholder:"请扫描或手动录入条码"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.SaveOption(e)}},model:{value:t.input_str,callback:function(e){t.input_str="string"===typeof e?e.trim():e},expression:"input_str"}})],1),a("dd",[a("el-button",{on:{click:t.cancelOption}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.SaveOption}},[t._v("确定")])],1)])])},s=[],n=(a("ac6a"),{props:["BarCodeList","ApiUrl","task_index","firstRequest"],data:function(){return{input_str:""}},created:function(){},mounted:function(){},methods:{cancelOption:function(){this.$emit("to-father","")},SaveOption:function(){var t=this;this.GLOBAL.VerificationHandle([{val:this.input_str,type:"StringNotEmpty",msg:"扫描条码不能为空！"}])&&(this.$props.firstRequest?axios("".concat(this.$props.ApiUrl,"/").concat(this.input_str)).then(function(e){if(200==e.data.Code)if(t.$props.task_index>=0)t.$emit("to-father",{data:e.data.Data,index:t.$props.task_index});else{if(e.data.Data.PackageBarCodeScannerVm)for(var a=0;a<t.$props.BarCodeList.length;a++)if(t.$props.BarCodeList[a].BarCode==e.data.Data.PackageBarCodeScannerVm.BarCode)return t.showInformation({classify:"message",msg:"该条码已录入！",type:"warning"}),void(t.input_str="");t.$emit("to-father",e.data.Data,t.input_str)}else 300==e.data.Code?(t.input_str="",t.showInformation({classify:"message",msg:e.data.Msg,type:"warning"})):(t.input_str="",t.showInformation({classify:"message",msg:e.data.Msg,type:"error"}))}).catch(function(t){}):(this.$props.BarCodeList.forEach(function(e){if(e.BarCode==t.input_str.toUpperCase())return t.showInformation({classify:"message",msg:"该条码已录入！",type:"warning"}),void(t.input_str="")}),axios("".concat(this.$props.ApiUrl,"/").concat(this.input_str)).then(function(e){200==e.data.Code?t.$props.task_index>=0?t.$emit("to-father",{data:e.data.Data,index:t.$props.task_index}):t.$emit("to-father",e.data.Data,t.input_str):300==e.data.Code?(t.input_str="",t.showInformation({classify:"message",msg:e.data.Msg,type:"warning"})):(t.input_str="",t.showInformation({classify:"message",msg:e.data.Msg,type:"error"}))}).catch(function(t){})))}}}),r=n,o=(a("dda8"),a("2877")),c=Object(o["a"])(r,i,s,!1,null,null,null);e["a"]=c.exports},dda8:function(t,e,a){"use strict";var i=a("9460"),s=a.n(i);s.a}}]);