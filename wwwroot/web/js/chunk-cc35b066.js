(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cc35b066"],{"0a64":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"cssd_box",attrs:{id:"outerPackageRegistration"}},[e("div",{staticClass:"cssd_title"},[e("ul",{staticClass:"cssd_menu"},[e("li",{on:{click:t.goBack}},[e("p",[t._v("返回")])]),t.outerPackageChangeMode?t._e():e("router-link",{attrs:{to:"/outerPackage/record",tag:"li"}},[e("p",[t._v("外来器械记录")])])],1),e("div",{staticClass:"cssd_title_right"},[e("p",[t._v("备用包登记")]),e("el-switch",{attrs:{"active-color":"#01BF6A","inactive-color":"#dbdde6","active-value":!0,"inactive-value":!1,disabled:t.outerPackageChangeMode},on:{change:t.switchChange},model:{value:t.submitData.IsBackupPackage,callback:function(a){t.$set(t.submitData,"IsBackupPackage",a)},expression:"submitData.IsBackupPackage"}})],1)]),e("div",{staticClass:"cssd_table_center cssd_totalBar"},[e("div",{staticClass:"table_box"},[t.submitData.IsBackupPackage||t.outerPackageChangeMode?t._e():e("ol",{staticClass:"search_box"},[e("li",[e("span",{staticClass:"font16gray"},[t._v("住院号")]),e("p",[e("el-input",{attrs:{placeholder:"请输入住院号"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.searchOuterPackage(a)}},model:{value:t.search_HospitalId,callback:function(a){t.search_HospitalId="string"===typeof a?a.trim():a},expression:"search_HospitalId"}})],1)]),e("li",[e("el-button",{staticClass:"btn120x40",attrs:{type:"primary"},on:{click:t.searchOuterPackage}},[t._v("查询")])],1)]),(t.GLOBAL.UserInfo.HospitalVersion="TONGJI")?[t.submitData.IsBackupPackage?t._e():e("ul",[e("li",[e("p",{staticClass:"font16gray"},[t._v("住院号")]),e("div",{staticClass:"el_input_box font16blod"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:!0},model:{value:t.submitData.Patient.HospitalId,callback:function(a){t.$set(t.submitData.Patient,"HospitalId","string"===typeof a?a.trim():a)},expression:"submitData.Patient.HospitalId"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("床号")]),e("div",{staticClass:"el_input_box font16blod"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.BedId,callback:function(a){t.$set(t.submitData.Patient,"BedId","string"===typeof a?a.trim():a)},expression:"submitData.Patient.BedId"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("病人姓名")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.PatientName,callback:function(a){t.$set(t.submitData.Patient,"PatientName","string"===typeof a?a.trim():a)},expression:"submitData.Patient.PatientName"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("门诊类型")]),e("div",{staticClass:"el_input_box"},[e("el-select",{staticClass:"font16blod green24x13",attrs:{disabled:t.forbid},model:{value:t.submitData.OutpatientType,callback:function(a){t.$set(t.submitData,"OutpatientType",a)},expression:"submitData.OutpatientType"}},[e("el-option",{attrs:{label:"择期",value:0}}),e("el-option",{attrs:{label:"急诊",value:1}})],1)],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("病区")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.SubClinic,callback:function(a){t.$set(t.submitData.Patient,"SubClinic","string"===typeof a?a.trim():a)},expression:"submitData.Patient.SubClinic"}})],1)])]),t.submitData.IsBackupPackage?t._e():e("ul",[e("li",[e("p",{staticClass:"font16gray"},[t._v("手术名称")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.SurgicalName,callback:function(a){t.$set(t.submitData.Patient,"SurgicalName","string"===typeof a?a.trim():a)},expression:"submitData.Patient.SurgicalName"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("手术时间")]),e("div",{staticClass:"el_input_box"},[e("el-date-picker",{staticClass:"font16blod",attrs:{editable:!1,clearable:!1,type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",disabled:t.forbid},model:{value:t.submitData.Patient.SurgicalDate,callback:function(a){t.$set(t.submitData.Patient,"SurgicalDate",a)},expression:"submitData.Patient.SurgicalDate"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("手术间")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.SurgicalRoom,callback:function(a){t.$set(t.submitData.Patient,"SurgicalRoom","string"===typeof a?a.trim():a)},expression:"submitData.Patient.SurgicalRoom"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("台次")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.Stage,callback:function(a){t.$set(t.submitData.Patient,"Stage","string"===typeof a?a.trim():a)},expression:"submitData.Patient.Stage"}})],1)])])]:t._e(),"TONGJI"!=t.GLOBAL.UserInfo.HospitalVersion?[t.submitData.IsBackupPackage?t._e():e("ul",[e("li",[e("p",{staticClass:"font16gray"},[t._v("住院号")]),e("div",{staticClass:"el_input_box font16blod"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:!0},model:{value:t.submitData.Patient.HospitalId,callback:function(a){t.$set(t.submitData.Patient,"HospitalId","string"===typeof a?a.trim():a)},expression:"submitData.Patient.HospitalId"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("床号")]),e("div",{staticClass:"el_input_box font16blod"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.BedId,callback:function(a){t.$set(t.submitData.Patient,"BedId","string"===typeof a?a.trim():a)},expression:"submitData.Patient.BedId"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("病人姓名")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.PatientName,callback:function(a){t.$set(t.submitData.Patient,"PatientName","string"===typeof a?a.trim():a)},expression:"submitData.Patient.PatientName"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("门诊类型")]),e("div",{staticClass:"el_input_box"},[e("el-select",{staticClass:"font16blod green24x13",attrs:{disabled:t.forbid},model:{value:t.submitData.OutpatientType,callback:function(a){t.$set(t.submitData,"OutpatientType",a)},expression:"submitData.OutpatientType"}},[e("el-option",{attrs:{label:"择期",value:0}}),e("el-option",{attrs:{label:"急诊",value:1}})],1)],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("病区")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.SubClinic,callback:function(a){t.$set(t.submitData.Patient,"SubClinic","string"===typeof a?a.trim():a)},expression:"submitData.Patient.SubClinic"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("性别")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.Gender,callback:function(a){t.$set(t.submitData.Patient,"Gender","string"===typeof a?a.trim():a)},expression:"submitData.Patient.Gender"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("年龄")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.Age,callback:function(a){t.$set(t.submitData.Patient,"Age","string"===typeof a?a.trim():a)},expression:"submitData.Patient.Age"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("入院时间")]),e("div",{staticClass:"el_input_box"},[e("el-date-picker",{staticClass:"font16blod",attrs:{editable:!1,clearable:!1,type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",disabled:t.forbid},model:{value:t.submitData.Patient.AdmissionDate,callback:function(a){t.$set(t.submitData.Patient,"AdmissionDate",a)},expression:"submitData.Patient.AdmissionDate"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("使用科室")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.Clinic,callback:function(a){t.$set(t.submitData.Patient,"Clinic","string"===typeof a?a.trim():a)},expression:"submitData.Patient.Clinic"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("挂号科室")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.RegisteredClinic,callback:function(a){t.$set(t.submitData.Patient,"RegisteredClinic","string"===typeof a?a.trim():a)},expression:"submitData.Patient.RegisteredClinic"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("挂号时间")]),e("div",{staticClass:"el_input_box"},[e("el-date-picker",{staticClass:"font16blod",attrs:{editable:!1,clearable:!1,type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",disabled:t.forbid},model:{value:t.submitData.Patient.RegisteredDate,callback:function(a){t.$set(t.submitData.Patient,"RegisteredDate",a)},expression:"submitData.Patient.RegisteredDate"}})],1)])]),t.submitData.IsBackupPackage?t._e():e("ul",[e("li",[e("p",{staticClass:"font16gray"},[t._v("手术名称")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.SurgicalName,callback:function(a){t.$set(t.submitData.Patient,"SurgicalName","string"===typeof a?a.trim():a)},expression:"submitData.Patient.SurgicalName"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("医生姓名")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.SurgicalDoctor,callback:function(a){t.$set(t.submitData.Patient,"SurgicalDoctor","string"===typeof a?a.trim():a)},expression:"submitData.Patient.SurgicalDoctor"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("手术时间")]),e("div",{staticClass:"el_input_box"},[e("el-date-picker",{staticClass:"font16blod",attrs:{editable:!1,clearable:!1,type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",disabled:t.forbid},model:{value:t.submitData.Patient.SurgicalDate,callback:function(a){t.$set(t.submitData.Patient,"SurgicalDate",a)},expression:"submitData.Patient.SurgicalDate"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("手术部位")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.SurgicalSite,callback:function(a){t.$set(t.submitData.Patient,"SurgicalSite","string"===typeof a?a.trim():a)},expression:"submitData.Patient.SurgicalSite"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("手术间")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.SurgicalRoom,callback:function(a){t.$set(t.submitData.Patient,"SurgicalRoom","string"===typeof a?a.trim():a)},expression:"submitData.Patient.SurgicalRoom"}})],1)]),e("li",[e("p",{staticClass:"font16gray"},[t._v("台次")]),e("div",{staticClass:"el_input_box"},[e("el-input",{staticClass:"font16blod",attrs:{disabled:t.forbid},model:{value:t.submitData.Patient.Stage,callback:function(a){t.$set(t.submitData.Patient,"Stage","string"===typeof a?a.trim():a)},expression:"submitData.Patient.Stage"}})],1)])])]:t._e(),e("div",{staticClass:"table_unExpand"},[e("el-table",{attrs:{data:t.submitData.Packages}},[e("el-table-column",{attrs:{label:"包名称",prop:"ProductName",width:"240","show-overflow-tooltip":!0}}),e("el-table-column",{attrs:{label:"分包数",prop:"SplitPackageCount",width:"110"}}),e("el-table-column",{attrs:{label:"有无植入物",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(t._s(a.row.HasImplants?"有":"无"))]}}])}),e("el-table-column",{attrs:{label:"清洗架",width:"210"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(t._s(a.row.CarrierName))]}}])}),e("el-table-column",{attrs:{label:"送包单位",prop:"SupplierName",width:"150"}}),e("el-table-column",{attrs:{label:"送包人",prop:"DeliveryPerson",width:"150"}}),e("el-table-column",{attrs:{label:"操作",width:"110"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"table_option"},[e("el-button",{staticClass:"editThisRow",attrs:{type:"primary",disabled:a.row.CanNotBeModified,size:"mini"},on:{click:function(e){return t.editThisRow(a.$index)}}},[t._v("修改")]),e("el-button",{staticClass:"deleteThisRow",attrs:{disabled:a.row.CanNotBeModified,size:"mini"},on:{click:function(e){return t.deleteThisRow(a.$index)}}},[t._v("删除")])],1)]}}])}),e("el-table-column")],1)],1),e("el-button",{staticClass:"btn120x40",staticStyle:{"margin-top":"30px"},attrs:{type:"primary"},on:{click:t.handleAddPackage}},[t._v("新增")])],2),e("div",{staticClass:"cssd_table_bottom"},[e("p",[t.outerPackageChangeMode?e("el-button",{attrs:{round:""},on:{click:t.cancelChange}},[t._v("取消修改")]):t._e(),e("el-button",{attrs:{type:"primary",round:""},on:{click:t.submitComplete}},[t._v(t._s(t.outerPackageChangeMode?"修改完成":"保存"))])],1)])]),e("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[t.isShowAddPackage?e("AddPackage",{attrs:{data:t.dataToChild,index:t.index,mode:t.mode,isBackupPackage:t.submitData.IsBackupPackage},on:{"addPackage-father":t.addPackage2father}}):t._e()],1)],1)},s=[],n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"outerPackage"}},[e("div",{staticClass:"box"},[e("div",{staticClass:"container"},[e("ul",[e("li",[e("p",{staticClass:"font16gray"},[t._v("送包单位")]),e("el-select",{staticClass:"green24x13",attrs:{filterable:"",disabled:t.$props.mode},on:{change:t.supplierChange},model:{value:t.outerPackageVm.SupplierId,callback:function(a){t.$set(t.outerPackageVm,"SupplierId",a)},expression:"outerPackageVm.SupplierId"}},t._l(t.SupplierList.Suppliers,function(t,a){return e("el-option",{key:a,attrs:{label:t.SupplierName,value:t.SupplierId}})}),1)],1),e("li",[e("p",{staticClass:"font16gray"},[t._v("送包人")]),e("el-input",{model:{value:t.outerPackageVm.DeliveryPerson,callback:function(a){t.$set(t.outerPackageVm,"DeliveryPerson","string"===typeof a?a.trim():a)},expression:"outerPackageVm.DeliveryPerson"}})],1),e("li",[e("p",{staticClass:"font16gray"},[t._v("包名称")]),e("el-select",{staticClass:"green24x13",attrs:{filterable:"",disabled:t.$props.mode},on:{change:t.productChange},model:{value:t.outerPackageVm.ProductId,callback:function(a){t.$set(t.outerPackageVm,"ProductId",a)},expression:"outerPackageVm.ProductId"}},t._l(t.SupplierList.Products,function(t,a){return e("el-option",{key:a,attrs:{label:t.ProductName,value:t.ProductId}})}),1)],1),e("li",[e("p",{staticClass:"font16gray"},[t._v("分包数")]),e("el-input-number",{attrs:{controls:!1,min:1,max:999},on:{change:function(a,e){t.handleNumberChange(a,e,"SplitPackageCount")}},model:{value:t.outerPackageVm.SplitPackageCount,callback:function(a){t.$set(t.outerPackageVm,"SplitPackageCount",a)},expression:"outerPackageVm.SplitPackageCount"}})],1),e("li",[e("p",{staticClass:"font16gray"},[t._v("植入物")]),e("el-select",{staticClass:"green24x13",model:{value:t.outerPackageVm.HasImplants,callback:function(a){t.$set(t.outerPackageVm,"HasImplants",a)},expression:"outerPackageVm.HasImplants"}},[e("el-option",{attrs:{label:"无",value:!1}}),e("el-option",{attrs:{label:"有",value:!0}})],1)],1),e("li",[e("p",{staticClass:"font16gray"},[t._v("清洗架")]),e("el-input",{on:{blur:function(a){return t.getCarrierData(t.outerPackageVm.CarrierName)}},model:{value:t.outerPackageVm.CarrierName,callback:function(a){t.$set(t.outerPackageVm,"CarrierName","string"===typeof a?a.trim():a)},expression:"outerPackageVm.CarrierName"}})],1),e("li",[e("p",{staticClass:"font16gray"},[t._v("器械总数")]),e("el-input-number",{attrs:{controls:!1,min:1,max:999},on:{change:function(a,e){t.handleNumberChange(a,e,"InstrumentTotalCount")}},model:{value:t.outerPackageVm.InstrumentTotalCount,callback:function(a){t.$set(t.outerPackageVm,"InstrumentTotalCount",a)},expression:"outerPackageVm.InstrumentTotalCount"}})],1)]),e("div",{staticClass:"table_unExpand"},[e("el-table",{attrs:{data:t.outerPackageVm.Instruments,height:"300"}},[e("el-table-column",{attrs:{prop:"Name",label:"名称"}}),e("el-table-column",{attrs:{prop:"Specification",label:"规格"}}),e("el-table-column",{attrs:{label:"数量",width:"140"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input-number",{attrs:{min:1,max:999,controls:!1,size:"mini"},on:{change:function(e,i){t.handleCountNumberPackage(e,i,a.$index)}},model:{value:a.row.Quantity,callback:function(e){t.$set(a.row,"Quantity",e)},expression:"props.row.Quantity"}})]}}])}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("a",{on:{click:function(e){return t.deleteThisPackage(a.$index)}}},[t._v("删除")])]}}])})],1)],1),t.$props.isBackupPackage?t._e():e("el-button",{staticClass:"btn88x32",staticStyle:{"margin-top":"30px"},attrs:{type:"primary"},on:{click:t.addInstrument}},[t._v("新增")])],1),e("h4",{staticStyle:{"text-align":"center"}},[e("el-button",{staticClass:"btn88x32empty",on:{click:t.cancelAdd}},[t._v("取消")]),e("el-button",{staticClass:"btn88x32",attrs:{type:"primary"},on:{click:t.completeAdd}},[t._v("确定")])],1)]),e("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[t.isShowInstrumentList?e("InstrumentList",{on:{"to-father":t.InstrumentList2Father}}):t._e()],1)],1)},o=[],l=(e("ac6a"),e("8423")),r={data:function(){return{isShowInstrumentList:!1,input2:"",SupplierList:{Suppliers:[],Products:[]},outerPackageVm:{}}},components:{InstrumentList:l["a"]},props:["data","index","mode","isBackupPackage"],created:function(){var t=this;CSManager.handleDataThis=this,this.outerPackageVm=this.$props.data,axios({url:"/api/Recycle/OuterProduct/Suppliers"}).then(function(a){200==a.data.Code?(t.SupplierList.Suppliers=a.data.Data,-1!=t.$props.index&&t.SupplierList.Suppliers.forEach(function(a){if(a.SupplierId==t.outerPackageVm.SupplierId)return t.outerPackageVm.SupplierName=a.SupplierName,void(t.SupplierList.Products=a.Products)})):t.showInformation({classify:"message",msg:a.data.Msg})}).catch(function(t){})},mounted:function(){},beforeDestroy:function(){CSManager.handleDataThis=null},methods:{handleCountNumberPackage:function(t,a,e){var i=this;void 0==t&&setTimeout(function(){i.outerPackageVm.Instruments[e].Quantity=1},0)},handleNumberChange:function(t,a,e){var i=this;void 0==t&&setTimeout(function(){i.outerPackageVm[e]=1},0)},getCarrierData:function(t){var a=this;t&&(/^QXW/.test(t.toUpperCase())?axios({url:"/api/Scanner/Recycle/".concat(t)}).then(function(t){var e;200==t.data.Code?(e="success",a.outerPackageVm.CarrierId=t.data.Data.CarrierBarCodeScannerVm.Id,a.outerPackageVm.CarrierName=t.data.Data.CarrierBarCodeScannerVm.Name):e="error",a.showInformation({classify:"message",msg:t.data.Msg,type:e})}).catch(function(t){}):this.showInformation({classify:"message",msg:"请输入清洗架条码！"}))},completeAdd:function(){this.GLOBAL.VerificationHandle([{val:this.outerPackageVm.SupplierId,type:"StringNotEmpty",msg:"您没有选择送包单位！请选择送包单位！"},{val:this.outerPackageVm.DeliveryPerson,type:"StringNotEmpty",msg:"送包人不能为空！"},{val:this.outerPackageVm.ProductId,type:"StringNotEmpty",msg:"您没有选择包名称！请选择包名称！"},{val:this.outerPackageVm.CarrierId,type:"NumberNotZero",msg:"清洗架输入有误！请重扫清洗架条码或重新输入清洗架条码！"}])&&this.$emit("addPackage-father",{data:this.outerPackageVm,index:this.$props.index})},supplierChange:function(t){var a=this;this.outerPackageVm.ProductId="",this.outerPackageVm.ProductName="",this.SupplierList.Suppliers.forEach(function(e){if(e.SupplierId==t)return a.outerPackageVm.SupplierName=e.SupplierName,void(a.SupplierList.Products=e.Products)})},productChange:function(t){var a=this;this.SupplierList.Products.forEach(function(e){if(e.ProductId==t)return a.outerPackageVm.ProductName=e.ProductName,void(a.outerPackageVm.ProvideSubClinicId=e.ProvideSubClinicId)})},deleteThisPackage:function(t){this.outerPackageVm.Instruments.splice(t,1)},addInstrument:function(){this.isShowInstrumentList=!0},cancelAdd:function(){this.$emit("addPackage-father","")},InstrumentList2Father:function(t){if(this.isShowInstrumentList=!1,t)if(""==this.outerPackageVm.Instruments)this.outerPackageVm.Instruments=t;else for(var a=0;a<t.length;a++){for(var e=!1,i=0;i<this.outerPackageVm.Instruments.length;i++)t[a].Id==this.outerPackageVm.Instruments[i].Id&&(e=!0,this.outerPackageVm.Instruments[i].Quantity+=t[a].Quantity);e||this.outerPackageVm.Instruments.push(t[a])}},handleBarCode:function(t){this.getCarrierData(t)}}},c=r,u=(e("8a19"),e("2877")),d=Object(u["a"])(c,n,o,!1,null,null,null),m=d.exports,p={data:function(){return{mode:!1,index:-1,dataToChild:"",search_HospitalId:"",isShowAddPackage:!1,forbid:!0,outerPackageChangeMode:!1,submitData:{IsBackupPackage:!1,OutpatientType:"",Patient:{HospitalId:"",BedId:"",PatientName:"",Gender:"",Age:"",AdmissionDate:"",Clinic:"",SubClinic:"",RegisteredClinic:"",RegisteredDate:"",SurgicalName:"",SurgicalDoctor:"",SurgicalRoom:"",SurgicalSite:"",SurgicalDate:"",Stage:""},Packages:[]}}},components:{AddPackage:m},created:function(){var t=this;this.$route.query.recordId&&(this.outerPackageChangeMode=!0,this.forbid=!1,axios({url:"/api/Recycle/PendingUpdateOuterProduct/".concat(this.$route.query.recordId)}).then(function(a){200==a.data.Code?t.submitData=a.data.Data:t.showInformation({classify:"message",msg:a.data.Msg})}).catch(function(t){}))},mounted:function(){this.GLOBAL.initWebSorcket(this)},methods:{goBack:function(){this.outerPackageChangeMode?this.$router.push("/outerPackage/record"):this.$router.push("/")},switchChange:function(t){this.search_HospitalId="",this.submitData={IsBackupPackage:t,OutpatientType:"",Patient:{HospitalId:"",BedId:"",PatientName:"",Gender:"",Age:"",AdmissionDate:"",Clinic:"",SubClinic:"",RegisteredClinic:"",RegisteredDate:"",SurgicalName:"",SurgicalDoctor:"",SurgicalRoom:"",SurgicalSite:"",SurgicalDate:"",Stage:""},Packages:[]}},searchOuterPackage:function(){var t=this;this.GLOBAL.VerificationHandle([{val:this.search_HospitalId,type:"StringNotEmpty",msg:"查询的住院号不能为空！"}])&&axios({url:"/api/Apply/MessageOfPatient/".concat(this.search_HospitalId)}).then(function(a){var e;t.forbid=!1,200==a.data.Code?(e="success",t.submitData.Patient=a.data.Data.Patient):300==a.data.Code?e="warning":(e="warning",t.submitData.Patient={HospitalId:t.search_HospitalId,PatientName:"",Gender:"",Age:"",AdmissionDate:"",Clinic:"",SubClinic:"",BedId:"",SurgicalName:"",SurgicalDoctor:"",RegisteredClinic:"",RegisteredDate:"",SurgicalRoom:"",SurgicalSite:"",SurgicalDate:"",Stage:""}),t.showInformation({classify:"message",msg:a.data.Msg,type:e})}).then(function(t){})},cancelChange:function(){this.$router.push("/outerPackage/record")},submitComplete:function(){var t="/api/Recycle/OuterProductRegister",a="POST";this.outerPackageChangeMode&&(t="/api/Recycle/OuterProductModify",a="PUT"),this.submitData.IsBackupPackage?this.GLOBAL.VerificationHandle([{val:this.submitData.Packages,type:"ArrayNotEmpty",msg:"您还没有添加外来器械包！请至少添加一个外来器械包！"}])&&(this.submitData.OutpatientType=0,this.submitRequest(t,a)):this.GLOBAL.VerificationHandle([{val:this.submitData.Patient.HospitalId,type:"StringNotEmpty",msg:"住院号不能为空！"},{val:this.submitData.Patient.BedId,type:"StringNotEmpty",msg:"床号不能为空！"},{val:this.submitData.Patient.PatientName,type:"StringNotEmpty",msg:"病人姓名不能为空！"},{val:this.submitData.OutpatientType,type:"StringNotEmpty",msg:"您还没有选择门诊类型！请选择门诊类型！"},{val:this.submitData.Packages,type:"ArrayNotEmpty",msg:"您还没有添加外来器械包！请至少添加一个外来器械包！"}])&&this.submitRequest(t,a)},submitRequest:function(t,a){var e=this;axios({url:t,method:a,data:this.submitData}).then(function(t){var a;if(200==t.data.Code){a="success";var i={CssdId:e.GLOBAL.UserInfo.ClinicId,ReserveCheckState:!1,PackageState:!0};0===e.GLOBAL.UserInfo.CssdProvideType?i.ProvideState=!0:1===e.GLOBAL.UserInfo.CssdProvideType&&(i.ProvideState=!1),e.websocket.send(JSON.stringify(i)),e.outerPackageChangeMode?e.$router.push("/outerPackage/record"):e.$router.go(0)}else a="error";e.showInformation({classify:"message",msg:t.data.Msg,type:a})}).catch(function(t){})},editThisRow:function(t){this.mode=this.outerPackageChangeMode,this.dataToChild=this.submitData.Packages[t],this.index=t,this.isShowAddPackage=!0},deleteThisRow:function(t){var a=this;this.$confirm("您确定要删除该包?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.submitData.Packages.splice(t,1)}).catch(function(){})},addPackage2father:function(t){this.isShowAddPackage=!1,t&&(-1==t.index?this.submitData.Packages.push(t.data):this.submitData.Packages[t.index]=t.data)},handleAddPackage:function(){this.dataToChild={SupplierId:"",SupplierName:"",DeliveryPerson:"",ProductId:"",ProductName:"",HasImplants:!1,CarrierId:0,CarrierName:"",SplitPackageCount:1,InstrumentTotalCount:1,Instruments:[]},this.index=-1,this.mode=!1,this.isShowAddPackage=!0}}},b=p,g=(e("b654"),Object(u["a"])(b,i,s,!1,null,null,null));a["default"]=g.exports},7711:function(t,a,e){},8423:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"basic_instrument instrumentListComponent"},[e("div",{staticClass:"instrument_box"},[e("h3",[e("el-input",{attrs:{placeholder:"请输入拼音简码"},on:{input:t.instrumentSearch},model:{value:t.searchShortCode,callback:function(a){t.searchShortCode=a},expression:"searchShortCode"}})],1),e("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",data:t.instrumentList,"tooltip-effect":"dark","max-height":"300",width:"400","row-key":t.getRowKeys},on:{"selection-change":t.handleSelectionChange,"row-click":t.handleRowClick}},[e("el-table-column",{attrs:{type:"selection",width:"55","reserve-selection":!0}}),e("el-table-column",{attrs:{prop:"Name",label:"名称",width:"120"}}),e("el-table-column",{attrs:{prop:"Specification",label:"规格",width:"80"}}),e("el-table-column",{attrs:{prop:"Quantity",label:"数量","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input-number",{staticClass:"inputNumber60x40",attrs:{min:1,max:999,controls:!1},on:{change:function(e,i){t.handleCountNumberPackage(e,i,a.$index)}},model:{value:a.row.Quantity,callback:function(e){t.$set(a.row,"Quantity",e)},expression:"scope.row.Quantity"}})]}}])})],1),e("h4",[e("el-button",{staticClass:"btn88x32empty",attrs:{type:"primary"},on:{click:t.cancelSend}},[t._v("取消")]),e("el-button",{staticClass:"btn88x32",attrs:{type:"primary"},on:{click:t.sendToFather}},[t._v("确定")])],1)],1)])},s=[],n=(e("ac6a"),e("aa47")),o={data:function(){return{searchShortCode:"",instrumentList:[],multipleSelection:[]}},methods:{handleRowClick:function(t){this.$refs.multipleTable.toggleRowSelection(t)},handleCountNumberPackage:function(t,a,e){var i=this;void 0==t&&setTimeout(function(){i.instrumentList[e].Quantity=1},0)},sendToFather:function(){this.$emit("to-father",this.multipleSelection)},cancelSend:function(){this.$emit("to-father",!1)},instrumentSearch:function(){var t=this;axios({url:"/odata/instruments?$filter=contains(name,".concat("'"+this.searchShortCode+"'",") or contains(shortcode,").concat("'"+this.searchShortCode+"'",")")}).then(function(a){t.instrumentList=a.data.value}).catch(function(t){})},handleSelectionChange:function(t){this.multipleSelection=t},getRowKeys:function(t){return t.Id},getInstrumentsData:function(t){var a=this;axios(t).then(function(t){t.data.value.forEach(function(t){t.Quantity=1}),a.instrumentList=t.data.value}).catch(function(t){})},rowDrop:function(){var t=this,a=document.querySelector(".instrumentListComponent .el-table__body-wrapper tbody");n["a"].create(a,{animation:180,delay:0,onEnd:function(a){var e=a.newIndex,i=a.oldIndex,s=t.instrumentList.splice(i,1)[0];t.instrumentList.splice(e,0,s)}})}},created:function(){this.getInstrumentsData("/odata/instruments")},mounted:function(){this.rowDrop()}},l=o,r=(e("d46a"),e("2877")),c=Object(r["a"])(l,i,s,!1,null,null,null);a["a"]=c.exports},"8a19":function(t,a,e){"use strict";var i=e("a2f1"),s=e.n(i);s.a},a2f1:function(t,a,e){},ac6a:function(t,a,e){for(var i=e("cadf"),s=e("0d58"),n=e("2aba"),o=e("7726"),l=e("32e9"),r=e("84f2"),c=e("2b4c"),u=c("iterator"),d=c("toStringTag"),m=r.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},b=s(p),g=0;g<b.length;g++){var f,h=b[g],P=p[h],C=o[h],v=C&&C.prototype;if(v&&(v[u]||l(v,u,m),v[d]||l(v,d,h),r[h]=m,P))for(f in i)v[f]||n(v,f,i[f],!0)}},b654:function(t,a,e){"use strict";var i=e("d617"),s=e.n(i);s.a},d46a:function(t,a,e){"use strict";var i=e("7711"),s=e.n(i);s.a},d617:function(t,a,e){}}]);