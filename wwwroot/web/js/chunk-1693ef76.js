(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1693ef76"],{"0c04":function(t,e,a){"use strict";var i=a("4c05"),o=a.n(i);o.a},1:function(t,e){},"1a10":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"photoView"}},[a("div",{staticClass:"container"},[a("div",{staticClass:"view_menu"},[t.$props.viewMode?t._e():a("h3",[a("p",{on:{click:t.switchToTakePhoto}})]),a("el-tabs",{attrs:{type:"card","tab-position":"left"},on:{"tab-click":t.tabClicked},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.list,function(e,i){return a("el-tab-pane",{key:i,attrs:{name:i+""}},[a("div",{staticClass:"imageListBox",attrs:{slot:"label"},slot:"label"},[a("img",{attrs:{src:e.Path||e.Base64String,alt:""}}),t.$props.viewMode?t._e():a("i",{staticClass:"deleteImg",on:{click:function(e){return e.stopPropagation(),t.deleteImg(i)}}})]),a("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.mode,expression:"mode==0"}],staticClass:"tab_content"},[a("img",{attrs:{src:e.Path||e.Base64String,alt:""}}),t.$props.viewMode?t._e():a("el-input",{attrs:{type:"textarea",placeholder:"备注",resize:"none"},model:{value:e.Remark,callback:function(a){t.$set(e,"Remark","string"===typeof a?a.trim():a)},expression:"item.Remark"}}),t.$props.viewMode?a("p",[t._v(t._s(e.Remark))]):t._e()],1)])],1)}),1)],1),a("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.mode,expression:"mode===1"}],staticClass:"view_content"},[a("img",{attrs:{src:t.image,alt:""}}),a("h5",[a("el-button",{staticClass:"btn120x40",on:{click:t.takePhoto}},[t._v("拍照")])],1)])]),a("i",{staticClass:"closePhotoView",on:{click:t.close}})],1)])},o=[],n={props:["data","viewMode","DeletedPicturesId"],data:function(){return{activeName:"-1",mode:0,image:"",list:[]}},created:function(){this.list=null==this.$props.data?[]:this.$props.data,this.list.length>0&&(this.activeName=0),this.$props.viewMode||this.switchToTakePhoto()},beforeDestroy:function(){CSManager.CloseVideo()},methods:{close:function(){this.$emit("viewPhoto-to-father",this.list)},switchToTakePhoto:function(){this.$props.viewMode||CSManager.OpenVideo(50,"",this),this.mode=1},takePhoto:function(){this.list.push({Id:0,Path:"",Base64String:this.image,Remark:""}),this.mode=0,this.activeName=this.list.length-1+""},deleteImg:function(t){var e=this;this.$confirm("您确定要删除该照片?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){0!=e.list[t].Id&&e.$props.DeletedPicturesId.push(e.list[t].Id),e.list.splice(t,1)}).catch(function(){})},tabClicked:function(){this.mode=0}}},s=n,r=(a("68c0"),a("2877")),l=Object(r["a"])(s,i,o,!1,null,null,null);e["a"]=l.exports},2:function(t,e){},2820:function(t,e,a){"use strict";var i=a("b040"),o=a.n(i);o.a},3:function(t,e){},"3ff3":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"basic_main"},[a("div",{staticClass:"basic_main_head"},[a("p",[a("el-input",{staticClass:"basic_ipt_search",attrs:{type:"text",placeholder:"搜索"},on:{input:t.searchThisTableData},model:{value:t.basic_search,callback:function(e){t.basic_search="string"===typeof e?e.trim():e},expression:"basic_search"}})],1),a("p",[t.GLOBAL.UserInfo.JobAndCompetence.includes("000")?a("a",{attrs:{href:"\\ImportBaseData\\产品汇入.xlsx",download:"产品汇入"}},[t._v("下载模板")]):t._e(),t.GLOBAL.UserInfo.JobAndCompetence.includes("000")?a("el-button",{staticClass:"importData"},[a("input",{attrs:{type:"file",id:"fileUploader",name:"fileUploader",accept:".xls, .xlsx"},on:{change:t.fileChange}})]):t._e(),a("el-button",{staticClass:"basic_ipt_add",attrs:{type:"primary"},on:{click:t.addTableTr}},[t._v("新增包")])],1)]),a("div",{staticClass:"basic_table table_unExpand"},[a("el-table",{attrs:{data:t.table_data}},[a("el-table-column",{attrs:{label:"包名称",prop:"Name",width:"240"}}),a("el-table-column",{attrs:{label:"简码",prop:"ShortCode",width:"210"}}),a("el-table-column",{attrs:{label:"操作",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"change_this_tr",on:{click:function(a){return a.stopPropagation(),t.editThisTr(e.$index)}}},[t._v("编辑")]),a("a",{staticClass:"delete_this_tr",on:{click:function(a){return a.stopPropagation(),t.deleteThisTr(e.$index)}}},[t._v("删除")])]}}])}),a("el-table-column")],1)],1),a("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[t.showEditBox?a("ProductBox",{attrs:{data:t.toChildData},on:{"to-father":t.child2father}}):t._e()],1)],1)},o=[],n=a("bd86"),s=(a("ac6a"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"editBox"}},[a("div",{staticClass:"editContainer"},[a("div",{staticClass:"editContent EditBoxContentOfProduct table_unExpand"},[a("ul",{staticClass:"clear_float"},[a("li",[a("p",[t._v("包名称")]),a("el-input",{attrs:{type:"text",placeholder:"包名称(必填)",maxlength:"10"},model:{value:t.editBoxData.Name,callback:function(e){t.$set(t.editBoxData,"Name","string"===typeof e?e.trim():e)},expression:"editBoxData.Name"}})],1),a("li",[a("p",[t._v("拼音简码")]),a("el-input",{attrs:{type:"text",disabled:!0},model:{value:t.editBoxData.ShortCode,callback:function(e){t.$set(t.editBoxData,"ShortCode",e)},expression:"editBoxData.ShortCode"}})],1),a("li",[a("p",[t._v("外包装")]),a("el-select",{staticClass:"green24x13",attrs:{placeholder:"请选择(必选)"},model:{value:t.editBoxData.ExternalPackage,callback:function(e){t.$set(t.editBoxData,"ExternalPackage",e)},expression:"editBoxData.ExternalPackage"}},t._l(t.optionExternalPackageList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),a("li",[a("p",[t._v("器械清单模板")]),a("el-select",{staticClass:"green24x13",attrs:{placeholder:"器械清单模板"},model:{value:t.editBoxData.InstrumentListTemplate,callback:function(e){t.$set(t.editBoxData,"InstrumentListTemplate",e)},expression:"editBoxData.InstrumentListTemplate"}},[a("el-option",{attrs:{label:"A4",value:0}}),a("el-option",{attrs:{label:"A5",value:1}})],1)],1),a("li",[a("p",[t._v("成本价格")]),a("el-input-number",{attrs:{placeholder:"成本价格",min:1,max:99999999,controls:!1},on:{change:function(e,a){t.numberChange(e,a,"CostPrice")}},model:{value:t.editBoxData.CostPrice,callback:function(e){t.$set(t.editBoxData,"CostPrice",e)},expression:"editBoxData.CostPrice"}})],1),a("li",[a("p",[t._v("清算价格")]),a("el-input-number",{attrs:{placeholder:"清算价格",min:1,max:99999999,controls:!1},on:{change:function(e,a){t.numberChange(e,a,"ClearingPrice")}},model:{value:t.editBoxData.ClearingPrice,callback:function(e){t.$set(t.editBoxData,"ClearingPrice",e)},expression:"editBoxData.ClearingPrice"}})],1),81!=t.editBoxData.Type?a("li",[a("p",[t._v("几张打印一张总条码")]),a("el-input-number",{attrs:{min:0,max:99999999,controls:!1},model:{value:t.editBoxData.HowManyProductsPrintATotalBarCode,callback:function(e){t.$set(t.editBoxData,"HowManyProductsPrintATotalBarCode",e)},expression:"editBoxData.HowManyProductsPrintATotalBarCode"}})],1):t._e(),81!=t.editBoxData.Type?a("li",[a("p",[t._v("是否打印器械明细")]),a("el-select",{staticClass:"green24x13",model:{value:t.editBoxData.IsPrintInstrumentDetail,callback:function(e){t.$set(t.editBoxData,"IsPrintInstrumentDetail",e)},expression:"editBoxData.IsPrintInstrumentDetail"}},[a("el-option",{attrs:{label:"是",value:!0}}),a("el-option",{attrs:{label:"否",value:!1}})],1)],1):t._e(),81!=t.editBoxData.Type?a("li",[a("p",[t._v("发放供应室")]),a("el-select",{staticClass:"green24x13",attrs:{placeholder:"请选择(必选)"},model:{value:t.editBoxData.ProvideCssdId,callback:function(e){t.$set(t.editBoxData,"ProvideCssdId",e)},expression:"editBoxData.ProvideCssdId"}},t._l(t.optionCssdList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1):t._e(),a("li",[a("p",[t._v("发放科室")]),a("el-cascader",{attrs:{"expand-trigger":"hover",options:t.optionClinicList,placeholder:"请选择(必选)"},on:{change:t.handleChange},model:{value:t.selectedOptions,callback:function(e){t.selectedOptions=e},expression:"selectedOptions"}})],1),80==t.editBoxData.Type||82==t.editBoxData.Type||83==t.editBoxData.Type?a("li",[a("p",[t._v("发放生成方式")]),a("el-select",{staticClass:"green24x13",model:{value:t.editBoxData.ProvideGenerateType,callback:function(e){t.$set(t.editBoxData,"ProvideGenerateType",e)},expression:"editBoxData.ProvideGenerateType"}},[80==t.editBoxData.Type||82==t.editBoxData.Type?a("el-option",{attrs:{label:"回收生成发放",value:0}}):t._e(),a("el-option",{attrs:{label:"预定生成发放",value:1}}),83==t.editBoxData.Type?a("el-option",{attrs:{label:"配包生成发放",value:2}}):t._e()],1)],1):t._e(),81!=t.editBoxData.Type&&83!=t.editBoxData.Type?a("li",[a("p",[t._v("通用包")]),a("el-select",{staticClass:"green24x13",model:{value:t.editBoxData.IsCommonProduct,callback:function(e){t.$set(t.editBoxData,"IsCommonProduct",e)},expression:"editBoxData.IsCommonProduct"}},[a("el-option",{attrs:{label:"是",value:!0}}),a("el-option",{attrs:{label:"否",value:!1}})],1)],1):t._e(),81!=t.editBoxData.Type&&83!=t.editBoxData.Type?a("li",[a("p",[t._v("计数包")]),a("el-select",{staticClass:"green24x13",attrs:{disabled:t.singleCarrierProductForbid},on:{change:t.countPackageChange},model:{value:t.editBoxData.IsNotPrintBarCode,callback:function(e){t.$set(t.editBoxData,"IsNotPrintBarCode",e)},expression:"editBoxData.IsNotPrintBarCode"}},[a("el-option",{attrs:{label:"是",value:!0}}),a("el-option",{attrs:{label:"否",value:!1}})],1)],1):t._e(),81!=t.editBoxData.Type&&83!=t.editBoxData.Type?a("li",[a("p",[t._v("打印标签")]),a("el-select",{staticClass:"green24x13",attrs:{disabled:t.forbid||t.singleCarrierProductForbid},model:{value:t.editBoxData.IsPrintLabel,callback:function(e){t.$set(t.editBoxData,"IsPrintLabel",e)},expression:"editBoxData.IsPrintLabel"}},[a("el-option",{attrs:{label:"是",value:!0}}),a("el-option",{attrs:{label:"否",value:!1}})],1)],1):t._e(),81!=t.editBoxData.Type&&83!=t.editBoxData.Type?a("li",[a("p",[t._v("个数包")]),a("el-select",{staticClass:"green24x13",attrs:{disabled:t.singleCarrierProductForbid},on:{change:t.numberPackageChange},model:{value:t.editBoxData.IsNumberProduct,callback:function(e){t.$set(t.editBoxData,"IsNumberProduct",e)},expression:"editBoxData.IsNumberProduct"}},[a("el-option",{attrs:{label:"是",value:!0}}),a("el-option",{attrs:{label:"否",value:!1}})],1)],1):t._e(),81!=t.editBoxData.Type&&83!=t.editBoxData.Type?a("li",[a("p",[t._v("几个打一个包")]),a("el-input-number",{attrs:{min:0,controls:!1,disabled:t.numberForbid||t.singleCarrierProductForbid},on:{change:function(e,a){t.numberChange(e,a,"NumberProductQuantity")}},model:{value:t.editBoxData.NumberProductQuantity,callback:function(e){t.$set(t.editBoxData,"NumberProductQuantity",e)},expression:"editBoxData.NumberProductQuantity"}})],1):t._e(),81==t.editBoxData.Type?a("li",[a("p",[t._v("关联供应商")]),a("el-select",{staticClass:"green24x13",attrs:{filterable:"",placeholder:"请选择(必选)"},model:{value:t.editBoxData.SupplierId,callback:function(e){t.$set(t.editBoxData,"SupplierId",e)},expression:"editBoxData.SupplierId"}},t._l(t.suppliers,function(t,e){return a("el-option",{key:e,attrs:{label:t.Name,value:t.SupplierId}})}),1)],1):t._e(),80==t.editBoxData.Type?a("li",[a("p",[t._v("单网篮包")]),a("el-select",{staticClass:"green24x13",on:{change:t.singleCarrierProductChange},model:{value:t.editBoxData.IsSingleCarrierProduct,callback:function(e){t.$set(t.editBoxData,"IsSingleCarrierProduct",e)},expression:"editBoxData.IsSingleCarrierProduct"}},[a("el-option",{attrs:{label:"否",value:!1}}),a("el-option",{attrs:{label:"是",value:!0}})],1)],1):t._e(),a("li",{staticClass:"textareaBox"},[a("p",[t._v("备注")]),a("el-input",{attrs:{type:"textarea",placeholder:"填写备注",maxlength:"20","show-word-limit":""},model:{value:t.editBoxData.Remark,callback:function(e){t.$set(t.editBoxData,"Remark","string"===typeof e?e.trim():e)},expression:"editBoxData.Remark"}})],1)]),a("div",{staticClass:"photoOption"},[a("span",[t._v("已拍照片")]),a("p",[a("s",[t._v(t._s(t.computedPhotoNumber))]),a("a",{on:{click:t.handleShowPhotos}},[t._v("拍照")])])]),a("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[t.isShowPhoto?a("PhotoView",{attrs:{data:t.editBoxData.ProductPictures,DeletedPicturesId:t.editBoxData.DeletedPicturesId},on:{"viewPhoto-to-father":t.viewPhotoToFather}}):t._e()],1),a("el-tabs",{directives:[{name:"show",rawName:"v-show",value:81!=t.editBoxData.Type&&!t.editBoxData.IsNumberProduct,expression:"editBoxData.Type==81||editBoxData.IsNumberProduct?false:true"}],model:{value:t.tabActiveName,callback:function(e){t.tabActiveName=e},expression:"tabActiveName"}},[83!=t.editBoxData.Type?a("el-tab-pane",{attrs:{label:"器械",name:"first"}},[a("div",{staticClass:"packageDetail"},[a("el-table",{attrs:{data:t.editBoxData.InstrumentCounts,"row-key":t.getRowKeys,"min-width":"300"}},[a("el-table-column",{attrs:{prop:"Name",label:"名称",width:"240"}}),a("el-table-column",{attrs:{prop:"Specification",label:"规格",width:"210"}}),a("el-table-column",{attrs:{label:"数量",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{min:1,max:999,controls:!1,size:"mini"},on:{change:function(a){t.talbeNumberChange(a,"InstrumentCounts",e.$index)}},model:{value:e.row.Quantity,callback:function(a){t.$set(e.row,"Quantity",a)},expression:"props.row.Quantity"}})]}}],null,!1,2664333044)}),a("el-table-column",{attrs:{label:"操作",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{on:{click:function(a){return t.deleteInstrument(e.$index)}}},[t._v("删除")])]}}],null,!1,2867534677)}),a("el-table-column")],1),a("h5",[a("el-button",{staticClass:"btn88x32",attrs:{type:"primary"},on:{click:t.addInstrument}},[t._v("新增")])],1)],1)]):t._e(),a("el-tab-pane",{attrs:{label:"包原料",name:"second"}},[a("div",{staticClass:"packageDetail"},[a("el-table",{attrs:{data:t.editBoxData.MaterialCounts,"row-key":t.getRowKeys}},[a("el-table-column",{attrs:{prop:"Name",label:"名称",width:"240"}}),a("el-table-column",{attrs:{prop:"Specification",label:"规格",width:"210"}}),a("el-table-column",{attrs:{label:"数量",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{min:1,max:999,controls:!1,size:"mini"},on:{change:function(a){t.talbeNumberChange(a,"MaterialCounts",e.$index)}},model:{value:e.row.Quantity,callback:function(a){t.$set(e.row,"Quantity",a)},expression:"props.row.Quantity"}})]}}])}),a("el-table-column",{attrs:{label:"操作",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{on:{click:function(a){return t.deleteMaterial(e.$index)}}},[t._v("删除")])]}}])}),a("el-table-column")],1),a("h5",[a("el-button",{staticClass:"btn88x32",attrs:{type:"primary"},on:{click:t.addMaterial}},[t._v("新增")])],1)],1)])],1)],1),a("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[t.showInstrumentList?a("InstrumentList",{on:{"to-father":t.child2father}}):t._e()],1),a("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[t.showMaterialList?a("MaterialList",{on:{"to-father":t.child2father2}}):t._e()],1),a("div",{staticClass:"editBoxOption"},[a("el-button",{on:{click:t.editBoxCancelSave}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.editBoxSave}},[t._v("完成")])],1)],1)])}),r=[],l=a("aa47"),c=a("1a10"),d=a("8423"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"basic_instrument",attrs:{id:"basic_material"}},[a("div",{staticClass:"instrument_box"},[a("h3",[a("el-input",{attrs:{placeholder:"请输入拼音简码"},on:{input:t.materialSearch},model:{value:t.searchShortCode,callback:function(e){t.searchShortCode=e},expression:"searchShortCode"}})],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.materialList,"tooltip-effect":"dark","max-height":"300",width:"400","row-key":t.getRowKeys},on:{"selection-change":t.handleSelectionChange,"row-click":t.handleRowClick}},[a("el-table-column",{attrs:{type:"selection",width:"55","reserve-selection":!0}}),a("el-table-column",{attrs:{prop:"Name",label:"名称",width:"120"}}),a("el-table-column",{attrs:{prop:"Specification",label:"规格",width:"80"}}),a("el-table-column",{attrs:{prop:"Quantity",label:"数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{attrs:{min:1,max:999,controls:!1},on:{change:function(a,i){t.handleCountNumberPackage(a,i,e.$index)}},model:{value:e.row.Quantity,callback:function(a){t.$set(e.row,"Quantity",a)},expression:"scope.row.Quantity"}})]}}])})],1),a("h4",[a("el-button",{staticClass:"btn88x32empty",attrs:{type:"primary"},on:{click:t.cancelSend}},[t._v("取消")]),a("el-button",{staticClass:"btn88x32",attrs:{type:"primary"},on:{click:t.sendToFather}},[t._v("确定")])],1)],1)])},h=[],p={data:function(){return{searchShortCode:"",materialList:[],multipleSelection:[]}},methods:{handleRowClick:function(t){this.$refs.multipleTable.toggleRowSelection(t)},handleCountNumberPackage:function(t,e,a){var i=this;void 0==t&&setTimeout(function(){i.materialList[a].Quantity=1},0)},sendToFather:function(){this.$emit("to-father",this.multipleSelection)},cancelSend:function(){this.$emit("to-father",!1)},materialSearch:function(){},handleSelectionChange:function(t){this.multipleSelection=t},getRowKeys:function(t){return t.Id},getMaterialsData:function(t){var e=this;axios(t).then(function(t){t.data.value.forEach(function(t){t.Quantity=1}),e.materialList=t.data.value}).catch(function(t){})}},created:function(){this.getMaterialsData("/odata/productmaterials")}},m=p,f=(a("0c04"),a("2877")),x=Object(f["a"])(m,u,h,!1,null,"7aa0a79e",null),b=x.exports,v={props:["data"],data:function(){return{forbid:!0,numberForbid:!0,singleCarrierProductForbid:!1,editBoxData:{ProductPictures:[]},isShowPhoto:!1,showInstrumentList:!1,showMaterialList:!1,optionCssdList:[],optionClinicList:[],optionExternalPackageList:[],tabActiveName:"first",selectedOptions:[],suppliers:[]}},components:{InstrumentList:d["a"],MaterialList:b,PhotoView:c["a"]},created:function(){var t=this;this.editBoxData=this.$props.data,this.editBoxData.DeletedPicturesId=null==this.editBoxData.DeletedPicturesId?[]:this.editBoxData.DeletedPicturesId,0!=this.editBoxData.Id&&(this.editBoxData.IsNotPrintBarCode&&(this.forbid=!1),this.editBoxData.IsNumberProduct&&(this.numberForbid=!1),this.editBoxData.IsSingleCarrierProduct&&(this.singleCarrierProductForbid=!0)),83==this.editBoxData.Type&&(this.tabActiveName="second",0==this.editBoxData.Id&&(this.editBoxData.ProvideGenerateType=2)),axios({url:"/api/Product/EditProductData/".concat(this.editBoxData.Id)}).then(function(e){if(200==e.data.Code){if(t.optionCssdList=e.data.Data.ExternalPackageCssdClinic.Cssds,t.optionClinicList=e.data.Data.ExternalPackageCssdClinic.Clinics,t.optionExternalPackageList=e.data.Data.ExternalPackageCssdClinic.ExternalPackageSelectors,t.editBoxData.InstrumentCounts=e.data.Data.Instruments,t.editBoxData.MaterialCounts=e.data.Data.Materials,t.editBoxData.ProductPictures=e.data.Data.Pictures,0!=t.editBoxData.Id){for(var a=!1,i=0;i<t.optionClinicList.length;i++){for(var o=0;o<t.optionClinicList[i].children.length;o++)if(t.editBoxData.ProvideSubClinicId==t.optionClinicList[i].children[o].value){a=!0,t.editBoxData.ProvideClinicId=t.optionClinicList[i].value;break}if(a)break}t.selectedOptions.splice(0,1,t.editBoxData.ProvideClinicId),t.selectedOptions.splice(1,1,t.editBoxData.ProvideSubClinicId)}81==t.editBoxData.Type&&axios({url:"/api/Supplier/ByType/1"}).then(function(e){200==e.data.Code?t.suppliers=e.data.Data:t.showInformation({classify:"message",msg:e.data.Msg})}).catch(function(t){})}else t.showInformation({classify:"message",msg:e.data.Msg})}).catch(function(t){})},mounted:function(){this.rowDrop()},methods:{viewPhotoToFather:function(){this.isShowPhoto=!1},handleShowPhotos:function(){this.isShowPhoto=!0},talbeNumberChange:function(t,e,a){var i=this;void 0==t&&setTimeout(function(){i.editBoxData[e][a].Quantity=1},0)},numberChange:function(t,e,a){var i=this;void 0==t&&setTimeout(function(){i.editBoxData[a]=1},0)},numberPackageChange:function(t){t?this.numberForbid=!1:(this.numberForbid=!0,this.editBoxData.NumberProductQuantity=0)},countPackageChange:function(t){t?this.forbid=!1:(this.forbid=!0,this.editBoxData.IsPrintLabel=!1)},singleCarrierProductChange:function(t){t?(this.editBoxData.IsNotPrintBarCode=!1,this.editBoxData.IsPrintLabel=!1,this.editBoxData.IsNumberProduct=!1,this.editBoxData.NumberProductQuantity=0,this.singleCarrierProductForbid=!0):this.singleCarrierProductForbid=!1},getRowKeys:function(t){return t.Id},editBoxCancelSave:function(){this.$emit("to-father","")},editBoxSave:function(){var t=this,e="";e=0==this.editBoxData.Id?"post":"put",this.editBoxData.IsNumberProduct&&(this.editBoxData.InstrumentCounts=[]);var a=[{val:this.editBoxData.Name,type:"StringNotEmpty",msg:"包名称不能为空！"},{val:this.editBoxData.ExternalPackage,type:"StringNotEmpty",msg:"外包装不能为空！"},{val:this.editBoxData.ProvideSubClinicId,type:"StringNotEmpty",msg:"发放科室不能为空！"}];82!==this.editBoxData.Type&&80!==this.editBoxData.Type||(a.push({val:this.editBoxData.ProvideCssdId,type:"StringNotEmpty",msg:"发放供应室不能为空！"}),this.editBoxData.SupplierId=0,this.editBoxData.IsNumberProduct||a.push({val:this.editBoxData.InstrumentCounts,type:"ArrayNotEmpty",msg:"您还没有添加器械！请为该产品至少添加一个器械！"})),81===this.editBoxData.Type&&(a.push({val:this.editBoxData.SupplierId,type:"StringNotEmpty",msg:"外来器械包还没有关联供应商！"}),delete this.editBoxData.ProvideCssdId),83===this.editBoxData.Type&&(a.push({val:this.editBoxData.MaterialCounts,type:"ArrayNotEmpty",msg:"您还没有添加包原料！辅料包至少添加一个包原料！"}),a.push({val:this.editBoxData.ProvideCssdId,type:"StringNotEmpty",msg:"发放供应室不能为空！"}),this.editBoxData.SupplierId=0),this.GLOBAL.VerificationHandle(a)&&axios({url:"/api/Product",method:e,data:this.editBoxData}).then(function(e){var a;200==e.data.Code?(a="success",t.$emit("to-father",e.data.Data)):a="error",t.showInformation({classify:"message",msg:e.data.Msg,type:a})}).catch(function(t){})},addInstrument:function(){this.showInstrumentList=!0},deleteInstrument:function(t){this.editBoxData.InstrumentCounts.splice(t,1)},addMaterial:function(){this.showMaterialList=!0},deleteMaterial:function(t){this.editBoxData.MaterialCounts.splice(t,1)},handleChange:function(){this.editBoxData.ProvideClinicId=this.selectedOptions[0],this.editBoxData.ProvideSubClinicId=this.selectedOptions[1]},child2father:function(t){if(this.showInstrumentList=!1,t.length>0)if(0==this.editBoxData.InstrumentCounts.length)this.editBoxData.InstrumentCounts=t;else for(var e=0;e<t.length;e++){for(var a=!1,i=0;i<this.editBoxData.InstrumentCounts.length;i++)t[e].Id==this.editBoxData.InstrumentCounts[i].Id&&(a=!0,this.editBoxData.InstrumentCounts[i].Quantity+=t[e].Quantity);a||this.editBoxData.InstrumentCounts.push(t[e])}},child2father2:function(t){if(this.showMaterialList=!1,t.length>0)if(0==this.editBoxData.MaterialCounts.length)this.editBoxData.MaterialCounts=t;else for(var e=0;e<t.length;e++){for(var a=!1,i=0;i<this.editBoxData.MaterialCounts.length;i++)t[e].Id==this.editBoxData.MaterialCounts[i].Id&&(a=!0,this.editBoxData.MaterialCounts[i].Quantity+=t[e].Quantity);a||this.editBoxData.MaterialCounts.push(t[e])}},rowDrop:function(){var t=this;if(83!=this.editBoxData.Type){var e=document.querySelector(".EditBoxContentOfProduct #pane-first .el-table__body-wrapper tbody");l["a"].create(e,{animation:180,delay:0,onEnd:function(e){var a=e.newIndex,i=e.oldIndex,o=t.editBoxData.InstrumentCounts.splice(i,1)[0];t.editBoxData.InstrumentCounts.splice(a,0,o)}})}var a=document.querySelector(".EditBoxContentOfProduct #pane-second .el-table__body-wrapper tbody");l["a"].create(a,{animation:180,delay:0,onEnd:function(e){var a=e.newIndex,i=e.oldIndex,o=t.editBoxData.MaterialCounts.splice(i,1)[0];t.editBoxData.MaterialCounts.splice(a,0,o)}})}},computed:{computedPhotoNumber:function(){return null==this.editBoxData.ProductPictures?0:this.editBoxData.ProductPictures.length}}},C=v,D=(a("2820"),Object(f["a"])(C,s,r,!1,null,null,null)),B=D.exports,g=a("1146"),y=a.n(g),P={data:function(){return{Type:0,basic_search:"",table_data:[],showEditBox:!1,toChildData:{}}},components:{ProductBox:B},created:function(){},watch:{$route:{handler:function(t,e,a){var i=this;this.Type=t.params.Type-0,axios("/api/Product/ByType/"+this.Type).then(function(t){200==t.data.Code?i.table_data=t.data.Data:i.showInformation({classify:"message",msg:t.data.Msg})}).catch(function(t){})},immediate:!0}},mounted:function(){},methods:{fileChange:function(t){var e=this,a={},i=t.target.files[0],o=new FileReader;o.onload=function(t){var i=t.target.result,o=y.a.read(i,{type:"binary"});o.SheetNames.forEach(function(t){a[t]=y.a.utils.sheet_to_row_object_array(o.Sheets[t]).splice(1)});for(var n=function(t){a.Sheet1[t].InstrumentCounts=a.InstrumentCounts.filter(function(e){return e.ProductId===a.Sheet1[t].Id}),a.Sheet1[t].MaterialCounts=a.MaterialCounts.filter(function(e){return e.ProductId===a.Sheet1[t].Id})},s=0;s<a.Sheet1.length;s++)n(s);e.requestData(a.Sheet1,0)},o.onerror=function(t){this.showInformation({classify:"message",msg:"文件不能被读取！Code ".concat(t.target.error.code)})},o.readAsBinaryString(i)},requestData:function(t,e){var a=this;axios({url:"/api/Product",method:"POST",data:t[e]}).then(function(i){200==i.data.Code?(a.Type===t[e].Type&&(a.table_data=i.data.Data),e<t.length-1&&a.requestData(t,e+1)):a.showInformation({classify:"message",msg:i.data.Msg})}).catch(function(t){})},searchThisTableData:function(){this.baseDataSearch("/odata/products?$filter=type eq ".concat(encodeURI("'"+this.GLOBAL.ProductDictionary[this.Type]+"'")," and (contains(name,").concat("'"+this.basic_search+"'",") or contains(shortcode,").concat("'"+this.basic_search+"'","))"))},addTableTr:function(){this.toChildData=Object(n["a"])({Id:0,Name:"",SupplierId:"",ExternalPackage:"",CostPrice:1,ClearingPrice:1,ShortCode:"",ProvideCssdId:"",ProvideClinicId:"",ProvideSubClinicId:"",InstrumentListTemplate:0,HowManyProductsPrintATotalBarCode:0,IsPrintInstrumentDetail:!1,Remark:"",Type:this.Type,InstrumentCounts:[],MaterialCounts:[],ProductPictures:[],IsCommonProduct:!1,IsNotPrintBarCode:!1,IsNumberProduct:!1,IsPrintLabel:!1,IsSingleCarrierProduct:!1,NumberProductQuantity:0,ProvideGenerateType:0},"ProductPictures",[]),this.showEditBox=!0},deleteThisTr:function(t){var e=this;this.$confirm("您是否确定删除该项?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){axios.delete("/api/Product/".concat(e.Type,"/").concat(e.table_data[t].Id)).then(function(t){var a;200==t.data.Code?(a="success",e.table_data=t.data.Data):a="error",e.showInformation({classify:"message",msg:t.data.Msg,type:a})}).catch(function(t){})}).catch(function(){})},editThisTr:function(t){this.toChildData=JSON.parse(JSON.stringify(this.table_data[t])),this.showEditBox=!0},child2father:function(t){this.showEditBox=!1,t&&(this.table_data=t)}}},I=P,w=Object(f["a"])(I,i,o,!1,null,null,null);e["default"]=w.exports},"4c05":function(t,e,a){},"68c0":function(t,e,a){"use strict";var i=a("c38f"),o=a.n(i);o.a},7711:function(t,e,a){},8423:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"basic_instrument instrumentListComponent"},[a("div",{staticClass:"instrument_box"},[a("h3",[a("el-input",{attrs:{placeholder:"请输入拼音简码"},on:{input:t.instrumentSearch},model:{value:t.searchShortCode,callback:function(e){t.searchShortCode=e},expression:"searchShortCode"}})],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"highlight-current-row":"",data:t.instrumentList,"tooltip-effect":"dark","max-height":"300",width:"400","row-key":t.getRowKeys},on:{"selection-change":t.handleSelectionChange,"row-click":t.handleRowClick}},[a("el-table-column",{attrs:{type:"selection",width:"55","reserve-selection":!0}}),a("el-table-column",{attrs:{prop:"Name",label:"名称",width:"120"}}),a("el-table-column",{attrs:{prop:"Specification",label:"规格",width:"80"}}),a("el-table-column",{attrs:{prop:"Quantity",label:"数量","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{staticClass:"inputNumber60x40",attrs:{min:1,max:999,controls:!1},on:{change:function(a,i){t.handleCountNumberPackage(a,i,e.$index)}},model:{value:e.row.Quantity,callback:function(a){t.$set(e.row,"Quantity",a)},expression:"scope.row.Quantity"}})]}}])})],1),a("h4",[a("el-button",{staticClass:"btn88x32empty",attrs:{type:"primary"},on:{click:t.cancelSend}},[t._v("取消")]),a("el-button",{staticClass:"btn88x32",attrs:{type:"primary"},on:{click:t.sendToFather}},[t._v("确定")])],1)],1)])},o=[],n=(a("ac6a"),a("aa47")),s={data:function(){return{searchShortCode:"",instrumentList:[],multipleSelection:[]}},methods:{handleRowClick:function(t){this.$refs.multipleTable.toggleRowSelection(t)},handleCountNumberPackage:function(t,e,a){var i=this;void 0==t&&setTimeout(function(){i.instrumentList[a].Quantity=1},0)},sendToFather:function(){this.$emit("to-father",this.multipleSelection)},cancelSend:function(){this.$emit("to-father",!1)},instrumentSearch:function(){var t=this;axios({url:"/odata/instruments?$filter=contains(name,".concat("'"+this.searchShortCode+"'",") or contains(shortcode,").concat("'"+this.searchShortCode+"'",")")}).then(function(e){t.instrumentList=e.data.value}).catch(function(t){})},handleSelectionChange:function(t){this.multipleSelection=t},getRowKeys:function(t){return t.Id},getInstrumentsData:function(t){var e=this;axios(t).then(function(t){t.data.value.forEach(function(t){t.Quantity=1}),e.instrumentList=t.data.value}).catch(function(t){})},rowDrop:function(){var t=this,e=document.querySelector(".instrumentListComponent .el-table__body-wrapper tbody");n["a"].create(e,{animation:180,delay:0,onEnd:function(e){var a=e.newIndex,i=e.oldIndex,o=t.instrumentList.splice(i,1)[0];t.instrumentList.splice(a,0,o)}})}},created:function(){this.getInstrumentsData("/odata/instruments")},mounted:function(){this.rowDrop()}},r=s,l=(a("d46a"),a("2877")),c=Object(l["a"])(r,i,o,!1,null,null,null);e["a"]=c.exports},b040:function(t,e,a){},c38f:function(t,e,a){},d46a:function(t,e,a){"use strict";var i=a("7711"),o=a.n(i);o.a}}]);