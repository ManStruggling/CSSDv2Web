(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c025855"],{"2db5":function(t,a,n){},"2fdb":function(t,a,n){"use strict";var e=n("5ca1"),s=n("d2c8"),i="includes";e(e.P+e.F*n("5147")(i),"String",{includes:function(t){return!!~s(this,t,i).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},5147:function(t,a,n){var e=n("2b4c")("match");t.exports=function(t){var a=/./;try{"/./"[t](a)}catch(n){try{return a[e]=!1,!"/./"[t](a)}catch(s){}}return!0}},6762:function(t,a,n){"use strict";var e=n("5ca1"),s=n("c366")(!0);e(e.P,"Array",{includes:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")("includes")},9460:function(t,a,n){},ac6a:function(t,a,n){for(var e=n("cadf"),s=n("0d58"),i=n("2aba"),o=n("7726"),r=n("32e9"),c=n("84f2"),u=n("2b4c"),l=u("iterator"),d=u("toStringTag"),p=c.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=s(f),m=0;m<h.length;m++){var b,g=h[m],v=f[g],C=o[g],I=C&&C.prototype;if(I&&(I[l]||r(I,l,p),I[d]||r(I,d,g),c[g]=p,v))for(b in e)I[b]||i(I,b,e[b],!0)}},d040:function(t,a,n){"use strict";var e=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{attrs:{id:"manual_enter"}},[n("dl",[n("dt",[n("el-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{placeholder:"请扫描或手动录入条码"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.SaveOption(a)}},model:{value:t.input_str,callback:function(a){t.input_str="string"===typeof a?a.trim():a},expression:"input_str"}})],1),n("dd",[n("el-button",{on:{click:t.cancelOption}},[t._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.SaveOption}},[t._v("确定")])],1)])])},s=[],i=(n("ac6a"),{props:["BarCodeList","ApiUrl","task_index","firstRequest"],data:function(){return{input_str:""}},created:function(){},mounted:function(){},methods:{cancelOption:function(){this.$emit("to-father","")},SaveOption:function(){var t=this;this.GLOBAL.VerificationHandle([{val:this.input_str,type:"StringNotEmpty",msg:"扫描条码不能为空！"}])&&(this.$props.firstRequest?axios("".concat(this.$props.ApiUrl,"/").concat(this.input_str)).then(function(a){if(200==a.data.Code)if(t.$props.task_index>=0)t.$emit("to-father",{data:a.data.Data,index:t.$props.task_index});else{if(a.data.Data.PackageBarCodeScannerVm)for(var n=0;n<t.$props.BarCodeList.length;n++)if(t.$props.BarCodeList[n].BarCode==a.data.Data.PackageBarCodeScannerVm.BarCode)return t.showInformation({classify:"message",msg:"该条码已录入！",type:"warning"}),void(t.input_str="");t.$emit("to-father",a.data.Data,t.input_str)}else 300==a.data.Code?(t.input_str="",t.showInformation({classify:"message",msg:a.data.Msg,type:"warning"})):(t.input_str="",t.showInformation({classify:"message",msg:a.data.Msg,type:"error"}))}).catch(function(t){}):(this.$props.BarCodeList.forEach(function(a){if(a.BarCode==t.input_str.toUpperCase())return t.showInformation({classify:"message",msg:"该条码已录入！",type:"warning"}),void(t.input_str="")}),axios("".concat(this.$props.ApiUrl,"/").concat(this.input_str)).then(function(a){200==a.data.Code?t.$props.task_index>=0?t.$emit("to-father",{data:a.data.Data,index:t.$props.task_index}):t.$emit("to-father",a.data.Data,t.input_str):300==a.data.Code?(t.input_str="",t.showInformation({classify:"message",msg:a.data.Msg,type:"warning"})):(t.input_str="",t.showInformation({classify:"message",msg:a.data.Msg,type:"error"}))}).catch(function(t){})))}}}),o=i,r=(n("dda8"),n("2877")),c=Object(r["a"])(o,e,s,!1,null,null,null);a["a"]=c.exports},d2c8:function(t,a,n){var e=n("aae3"),s=n("be13");t.exports=function(t,a,n){if(e(a))throw TypeError("String#"+n+" doesn't accept regex!");return String(s(t))}},dda8:function(t,a,n){"use strict";var e=n("9460"),s=n.n(e);s.a},e7ed:function(t,a,n){"use strict";var e=n("2db5"),s=n.n(e);s.a},f889:function(t,a,n){"use strict";n.r(a);var e=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"cssd_box",attrs:{id:"putInInventory"}},[n("div",{staticClass:"cssd_title"},[n("ul",{staticClass:"cssd_menu"},[n("router-link",{attrs:{to:"/",tag:"li"}},[n("p",[t._v("返回")])]),n("li",{on:{click:t.handleShowManualEnter}},[n("p",[t._v("手工录入")])]),n("router-link",{attrs:{to:"/apply/putInInventoryRecord",tag:"li"}},[n("p",[t._v("入库记录")])])],1),n("div",{staticClass:"cssd_title_right"},[n("p",[n("span",[t._v("入库科室")]),n("el-select",{staticClass:"white24x13",attrs:{filterable:"","default-first-option":""},model:{value:t.putInTask.InboundSubClinicId,callback:function(a){t.$set(t.putInTask,"InboundSubClinicId",a)},expression:"putInTask.InboundSubClinicId"}},t._l(t.GLOBAL.UserInfo.SubClinics,function(t,a){return n("el-option",{key:a,attrs:{label:t.SubClinicName,value:t.SubClinicId}})}),1)],1)])]),n("div",{staticClass:"cssd_table_center cssd_totalBar"},[n("div",{staticClass:"table_box table_collapse table_unExpand"},[t._m(0),n("el-collapse",{attrs:{accordion:""},model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},t._l(t.putInTask.Products,function(a,e){return n("el-collapse-item",{key:e,class:a.IsNotPrintBarCode?"collapseUnExpand":"",attrs:{name:e+""}},[n("div",{staticClass:"collapseTh",attrs:{slot:"title"},slot:"title"},[n("div",{staticClass:"collapseTd"},[n("p",[t._v(t._s(a.ProductName))])]),n("div",{staticClass:"collapseTd"},[n("p",[t._v(t._s(a.RemainInboundCount))])]),n("div",{staticClass:"collapseTd"},[a.IsNotPrintBarCode?t._e():n("p",[t._v(t._s(t.countPackagesNumber(e)))]),a.IsNotPrintBarCode?n("p",[n("el-input-number",{attrs:{min:0,max:a.RemainInboundCount,controls:!1},on:{change:function(a,n){t.handleNumberChange(a,n,e)}},nativeOn:{click:function(a){return a.stopPropagation(),t.GLOBAL.cancelBubble(a)}},model:{value:a.ThisTimeInboundCount,callback:function(n){t.$set(a,"ThisTimeInboundCount",n)},expression:"value.ThisTimeInboundCount"}})],1):t._e()])]),a.IsNotPrintBarCode?t._e():n("el-table",{attrs:{data:a.Packages}},[n("el-table-column",{attrs:{label:"包名称",prop:"ProductName",width:"240"}}),n("el-table-column",{attrs:{label:"包条码",prop:"BarCode",width:"210"}}),n("el-table-column",{attrs:{label:"有效日期",prop:"ValidDate",width:"210"}}),n("el-table-column",{attrs:{label:"操作",width:"210"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("a",{on:{click:function(n){return t.deletePackage(a.Packages,e.$index)}}},[t._v("删除")])]}}],null,!0)}),n("el-table-column")],1)],1)}),1)],1),n("div",{staticClass:"cssd_table_bottom"},[n("p",[t._v("\n        共计 "),n("span",[t._v(t._s(t.countAllNumber))]),t._v(" 包\n      ")]),n("p",[n("el-button",{attrs:{type:"primary"},on:{click:t.submitComplete}},[t._v("入库完成")])],1)])]),n("transition",{attrs:{name:"fade","enter-active-class":"animated fadeIn faster","leave-active-class":"animated fadeOut faster"}},[t.isShowManualEnter?n("ManualEnter",{attrs:{BarCodeList:t.barCodeList,ApiUrl:"/api/Scanner/Inbound",PutInInventory:!0},on:{"to-father":t.packageData2father}}):t._e()],1)],1)},s=[function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"content_title"},[n("p",[t._v("包名称")]),n("p",[t._v("剩余入库数")]),n("p",[t._v("本次入库数")])])}],i=(n("ac6a"),n("6762"),n("2fdb"),n("d040")),o={data:function(){return{activeName:"-1",isShowManualEnter:!1,putInTask:{ProvideLogisticBarCode:"",InboundSubClinicId:"",Products:[]},barCodeList:[]}},components:{ManualEnter:i["a"]},beforeRouteEnter:function(t,a,n){sessionStorage.userInfo?UserInfo.JobAndCompetence.includes("261")||UserInfo.JobAndCompetence.includes("262")||UserInfo.JobAndCompetence.includes("000")||UserInfo.JobAndCompetence.includes("200")||UserInfo.JobAndCompetence.includes("202")?n():(n(a.path),VueVm.$message({type:"warning",message:"您没有使用模块访问权限！",center:!0,duration:2e3,showClose:!0})):n("/login")},created:function(){var t=this;CSManager.handleDataThis=this,axios({url:"/api/Inbound"}).then(function(a){200==a.data.Code?(a.data.Data.InboundSubClinicId="",t.putInTask=a.data.Data):t.showInformation({classify:"message",msg:a.data.Msg})}).catch(function(t){})},mounted:function(){},beforeDestroy:function(){CSManager.handleDataThis=null},methods:{deletePackage:function(t,a){this.$confirm("您确定要删除该包?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.splice(a,1)}).catch(function(){})},submitComplete:function(){var t=this;this.GLOBAL.VerificationHandle([{val:this.putInTask.InboundNumber,type:"NumberNotZero",msg:"您还没有添加包，请至少扫入一个包！"},{val:this.putInTask.InboundSubClinicId,type:"StringNotEmpty",msg:"请选择入库科室！"}])&&axios({url:"/api/Inbound",method:"POST",data:this.putInTask}).then(function(a){var n;200==a.data.Code?(n="success",t.putInTask=a.data.Data):n="error",t.showInformation({classify:"message",msg:a.data.Msg,type:n})})},handleNumberChange:function(t,a,n){var e=this;void 0==t&&setTimeout(function(){e.putInTask.Products[n].ThisTimeInboundCount=0},0)},handleShowManualEnter:function(){this.getBarCodeArray(),this.isShowManualEnter=!0},getBarCodeArray:function(){for(var t=[],a=0;a<this.putInTask.Products.length;a++)this.putInTask.Products[a].Packages&&(t=t.concat(this.putInTask.Products[a].Packages));this.barCodeList=t},packageData2father:function(t,a){if(this.isShowManualEnter=!1,t){t.length>0&&t[0].IsProvideLogisticTask&&(this.putInTask.ProvideLogisticBarCode=a);for(var n=0;n<t.length;n++)for(var e=0;e<this.putInTask.Products.length;e++)if(t[n].ProductId===this.putInTask.Products[e].ProductId&&this.putInTask.Products[e].ThisTimeInboundCount<this.putInTask.Products[e].RemainInboundCount){this.putInTask.Products[e].Packages.push(t[n]),this.activeName=e+"";break}}},handleBarCode:function(t){var a=this;this.getBarCodeArray();var n=!0;this.barCodeList.forEach(function(e){if(e.BarCode==t.toUpperCase())return a.showInformation({classify:"message",msg:"该条码已录入！",type:"warning"}),void(n=!1)}),n&&axios({url:"/api/Scanner/Inbound/".concat(t)}).then(function(n){200==n.data.Code?a.packageData2father(n.data.Data,t):a.showInformation({classify:"message",msg:n.data.Msg})}).catch(function(t){})}},computed:{countPackagesNumber:function(){var t=this;return function(a){return t.putInTask.Products[a].ThisTimeInboundCount=void 0==t.putInTask.Products[a].Packages?0:t.putInTask.Products[a].Packages.length,t.putInTask.Products[a].ThisTimeInboundCount}},countAllNumber:function(){var t=0;return this.putInTask.Products.forEach(function(a){t+=a.ThisTimeInboundCount}),this.putInTask.InboundNumber=t,t}}},r=o,c=(n("e7ed"),n("2877")),u=Object(c["a"])(r,e,s,!1,null,null,null);a["default"]=u.exports}}]);